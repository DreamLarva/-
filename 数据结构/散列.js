"use strict";
/**
 * 散列是一种常用的数据存储技术，散列后的数据可以快速地插入或取用。
 * 也可称为散列表 或者 哈希表
 * 散列使用的数据结构叫做散列表。
 * 在散列表上插入、删除和取用数据都非常快，但是对于查找操作来说却效率低下，比如查找一组数据中的最大值和最小值。
 * */
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * 散列表是基于数组进行设计的。
 * 数组的长度是预先设定的，如有需要，可以随时增加。
 * 所有元素根据和该元素对应的键，保存在数组的特定位置，该键和我们前面讲到的字典中的键是类似的概念。
 * 使用散列表存储数据时，通过一个散列函数将键映射为一个数字，这个数字的范围是 0 到散列表的长度。
 * 理想情况下，散列函数会将每个键值映射为一个唯一的数组索引。
 * 然而，键的数量是无限的，数组的长度是有限的（理论上，在 JavaScript 中是这样），
 * 一个更现实的目标是让散列函数尽量将键均匀地映射到数组中。
 * 即使使用一个高效的散列函数，仍然存在将两个键映射成同一个值的可能，这种现象称为碰撞（collision）。
 * 要确定的最后一个问题是：散列表中的数组究竟应该有多大？这是编写散列函数时必须要考虑的。
 * 对数组大小常见的限制是：数组长度应该是一个质数。
 * */
class HashTable {
    constructor() {
        this.table = new Array(137);
    }
    simpleHash(data) {
        let total = 0;
        for (let i = 0; i < data.length; i++) {
            total += data.charCodeAt(i);
        }
        return total % this.table.length;
    }
    put(data) {
        // 储存一个数据
        const pos = this.betterHash(data);
        this.table[pos] = data;
    }
    // 霍纳算法 更好的解决碰撞
    betterHash(string) {
        const H = 31;
        let total = 0;
        for (let i = 0; i < string.length; ++i) {
            total += H * total + string.charCodeAt(i);
        }
        total = total % this.table.length;
        if (total < 0) {
            total += this.table.length - 1;
        }
        return Math.floor(total);
    }
    putArr(arr) {
        // 储存多个数据
        arr.forEach((v) => {
            // 箭头函数绑定了作用域
            const pos = this.betterHash(v);
            this.table[pos] = v;
            // console.log(pos, v);
        });
    }
    showDistro() {
        // 打印所有数据
        for (let i = 0; i < this.table.length; ++i) {
            if (this.table[i] != undefined) {
                console.log(i + " : " + this.table[i]);
            }
        }
    }
}
const T = new HashTable();
T.putArr([
    "David",
    "Jennifer",
    "Donnie",
    "Raymond",
    "Cynthia",
    "Mike",
    "Clayton",
    "Danny",
    "Jonathan",
]);
T.showDistro();
console.log("-----------");
/**
 * 如果用散列来存储数据
 * 那么每个数据就必须要要一个主键 来作为key
 * */
class HashTableData {
    constructor() {
        this.table = new Array(137);
    }
    simpleHash(data) {
        let total = 0;
        for (let i = 0; i < data.length; i++) {
            total += data.charCodeAt(i);
        }
        return total % this.table.length;
    }
    // 霍纳算法 更好的解决碰撞
    betterHash(string) {
        const H = 31;
        let total = 0;
        for (let i = 0; i < string.length; ++i) {
            total += H * total + string.charCodeAt(i);
        }
        total = total % this.table.length;
        if (total < 0) {
            total += this.table.length - 1;
        }
        return Math.floor(total);
    }
    // 储存一个数据
    put(key, data) {
        const pos = this.betterHash(key);
        this.table[pos] = data;
    }
    get(key) {
        return this.table[this.betterHash(key)];
    }
    // 打印所有数据
    showDistro() {
        for (let i = 0; i < this.table.length; ++i) {
            if (this.table[i] != undefined) {
                console.log(i + " : " + JSON.stringify(this.table[i]));
            }
        }
    }
}
const TD = new HashTableData();
const data = { key: "123", value: "abc" };
TD.put(data.key, data);
TD.showDistro();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoi5pWj5YiXLmpzIiwic291cmNlUm9vdCI6Ii4vIiwic291cmNlcyI6WyLmlbDmja7nu5PmnoQv5pWj5YiXLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7S0FLSzs7QUFFTDs7Ozs7Ozs7Ozs7S0FXSztBQUVMLE1BQU0sU0FBUztJQUFmO1FBQ0UsVUFBSyxHQUFhLElBQUksS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBZ0RuQyxDQUFDO0lBOUNDLFVBQVUsQ0FBQyxJQUFZO1FBQ3JCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztRQUNkLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ3BDLEtBQUssSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzdCO1FBQ0QsT0FBTyxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFDbkMsQ0FBQztJQUVELEdBQUcsQ0FBQyxJQUFZO1FBQ2QsU0FBUztRQUNULE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUM7SUFDekIsQ0FBQztJQUVELGVBQWU7SUFDZixVQUFVLENBQUMsTUFBYztRQUN2QixNQUFNLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDYixJQUFJLEtBQUssR0FBRyxDQUFDLENBQUM7UUFDZCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsRUFBRTtZQUN0QyxLQUFLLElBQUksQ0FBQyxHQUFHLEtBQUssR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzNDO1FBQ0QsS0FBSyxHQUFHLEtBQUssR0FBRyxJQUFJLENB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LEdBQUcsQ0FBQyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxHQUFHLENBQUMsR0FBVztRQUNiLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDMUMsQ0FBQztJQUVELFNBQVM7SUFDVCxVQUFVO1FBQ1IsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxFQUFFO1lBQzFDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxTQUFTLEVBQUU7Z0JBQzlCLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3hEO1NBQ0Y7SUFDSCxDQUFDO0NBQ0Y7QUFFRCxNQUFNLEVBQUUsR0FBRyxJQUFJLGFBQWEsRUFBRSxDQUFDO0FBQy9CLE1BQU0sSUFBSSxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUM7QUFDMUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3ZCLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog5pWj5YiX5piv5LiA56eN5bi455So55qE5pWw5o2u5a2Y5YKo5oqA5pyv77yM5pWj5YiX5ZCO55qE5pWw5o2u5Y+v5Lul5b+r6YCf5Zyw5o+S5YWl5oiW5Y+W55So44CCXG4gKiDkuZ/lj6/np7DkuLrmlaPliJfooagg5oiW6ICFIOWTiOW4jOihqFxuICog5pWj5YiX5L2/55So55qE5pWw5o2u57uT5p6E5Y+r5YGa5pWj5YiX6KGo44CCXG4gKiDlnKjmlaPliJfooajkuIrmj5LlhaXjgIHliKDpmaTlkozlj5bnlKjmlbDmja7pg73pnZ7luLjlv6vvvIzkvYbmmK/lr7nkuo7mn6Xmib7mk43kvZzmnaXor7TljbTmlYjnjofkvY7kuIvvvIzmr5TlpoLmn6Xmib7kuIDnu4TmlbDmja7kuK3nmoTmnIDlpKflgLzlkozmnIDlsI/lgLzjgIJcbiAqICovXG5cbi8qKlxuICog5pWj5YiX6KGo5piv5Z+65LqO5pWw57uE6L+b6KGM6K6+6K6h55qE44CCXG4gKiDmlbDnu4TnmoTplb/luqbmmK/pooTlhYjorr7lrprnmoTvvIzlpoLmnInpnIDopoHvvIzlj6/ku6Xpmo/ml7blop7liqDjgIJcbiAqIOaJgOacieWFg+e0oOagueaNruWSjOivpeWFg+e0oOWvueW6lOeahOmUru+8jOS/neWtmOWcqOaVsOe7hOeahOeJueWumuS9jee9ru+8jOivpemUruWSjOaIkeS7rOWJjemdouiusuWIsOeahOWtl+WFuOS4reeahOmUruaYr+exu+S8vOeahOamguW/teOAglxuICog5L2/55So5pWj5YiX6KGo5a2Y5YKo5pWw5o2u5pe277yM6YCa6L+H5LiA5Liq5pWj5YiX5Ye95pWw5bCG6ZSu5pig5bCE5Li65LiA5Liq5pWw5a2X77yM6L+Z5Liq5pWw5a2X55qE6IyD5Zu05pivIDAg5Yiw5pWj5YiX6KGo55qE6ZW/5bqm44CCXG4gKiDnkIbmg7Pmg4XlhrXkuIvvvIzmlaPliJflh73mlbDkvJrlsIbmr4/kuKrplK7lgLzmmKDlsITkuLrkuIDkuKrllK/kuIDnmoTmlbDnu4TntKLlvJXjgIJcbiAqIOeEtuiAjO+8jOmUrueahOaVsOmHj+aYr+aXoOmZkOeahO+8jOaVsOe7hOeahOmVv+W6puaYr+aciemZkOeahO+8iOeQhuiuuuS4iu+8jOWcqCBKYXZhU2NyaXB0IOS4reaYr+i/meagt++8ie+8jFxuICog5LiA5Liq5pu0546w5a6e55qE55uu5qCH5piv6K6p5pWj5YiX5Ye95pWw5bC96YeP5bCG6ZSu5Z2H5YyA5Zyw5pig5bCE5Yiw5pWw57uE5Lit44CCXG4gKiDljbPkvb/kvb/nlKjkuIDkuKrpq5jmlYjnmoTmlaPliJflh73mlbDvvIzku43nhLblrZjlnKjlsIbkuKTkuKrplK7mmKDlsITmiJDlkIzkuIDkuKrlgLznmoTlj6/og73vvIzov5nnp43njrDosaHnp7DkuLrnorDmkp7vvIhjb2xsaXNpb27vvInjgIJcbiAqIOimgeehruWumueahOacgOWQjuS4gOS4qumXrumimOaYr++8muaVo+WIl+ihqOS4reeahOaVsOe7hOeptuern+W6lOivpeacieWkmuWkp++8n+i/meaYr+e8luWGmeaVo+WIl+WHveaVsOaXtuW/hemhu+imgeiAg+iZkeeahOOAglxuICog5a+55pWw57uE5aSn5bCP5bi46KeB55qE6ZmQ5Yi25piv77ya5pWw57uE6ZW/5bqm5bqU6K+l5piv5LiA5Liq6LSo5pWw44CCXG4gKiAqL1xuXG5jbGFzcyBIYXNoVGFibGUge1xuICB0YWJsZTogc3RyaW5nW10gPSBuZXcgQXJyYXkoMTM3KTtcblxuICBzaW1wbGVIYXNoKGRhdGE6IHN0cmluZykge1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0b3RhbCArPSBkYXRhLmNoYXJDb2RlQXQoaSk7XG4gICAgfVxuICAgIHJldHVybiB0b3RhbCAlIHRoaXMudGFibGUubGVuZ3RoO1xuICB9XG5cbiAgcHV0KGRhdGE6IHN0cmluZykge1xuICAgIC8vIOWCqOWtmOS4gOS4quaVsOaNrlxuICAgIGNvbnN0IHBvcyA9IHRoaXMuYmV0dGVySGFzaChkYXRhKTtcbiAgICB0aGlzLnRhYmxlW3Bvc10gPSBkYXRhO1xuICB9XG5cbiAgLy8g6ZyN57qz566X5rOVIOabtOWlveeahOino+WGs+eisOaSnlxuICBiZXR0ZXJIYXNoKHN0cmluZzogc3RyaW5nKSB7XG4gICAgY29uc3QgSCA9IDMxO1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJpbmcubGVuZ3RoOyArK2kpIHtcbiAgICAgIHRvdGFsICs9IEggKiB0b3RhbCArIHN0cmluZy5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICB0b3RhbCA9IHRvdGFsICUgdGhpcy50YWJsZS5sZW5ndGg7XG4gICAgaWYgKHRvdGFsIDwgMCkge1xuICAgICAgdG90YWwgKz0gdGhpcy50YWJsZS5sZW5ndGggLSAxO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5mbG9vcih0b3RhbCk7XG4gIH1cblxuICBwdXRBcnIoYXJyOiBzdHJpbmdbXSkge1xuICAgIC8vIOWCqOWtmOWkmuS4quaVsOaNrlxuICAgIGFyci5mb3JFYWNoKCh2KSA9PiB7XG4gICAgICAvLyDnrq3lpLTlh73mlbDnu5HlrprkuobkvZznlKjln59cbiAgICAgIGNvbnN0IHBvcyA9IHRoaXMuYmV0dGVySGFzaCh2KTtcbiAgICAgIHRoaXMudGFibGVbcG9zXSA9IHY7XG4gICAgICAvLyBjb25zb2xlLmxvZyhwb3MsIHYpO1xuICAgIH0pO1xuICB9XG5cbiAgc2hvd0Rpc3RybygpIHtcbiAgICAvLyDmiZPljbDmiYDmnInmlbDmja5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGFibGUubGVuZ3RoOyArK2kpIHtcbiAgICAgIGlmICh0aGlzLnRhYmxlW2ldICE9IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zb2xlLmxvZyhpICsgXCIgOiBcIiArIHRoaXMudGFibGVbaV0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBUID0gbmV3IEhhc2hUYWJsZSgpO1xuVC5wdXRBcnIoW1xuICBcIkRhdmlkXCIsXG4gIFwiSmVubmlmZXJcIixcbiAgXCJEb25uaWVcIixcbiAgXCJSYXltb25kXCIsXG4gIFwiQ3ludGhpYVwiLFxuICBcIk1pa2VcIixcbiAgXCJDbGF5dG9uXCIsXG4gIFwiRGFubnlcIixcbiAgXCJKb25hdGhhblwiLFxuXSk7XG5ULnNob3dEaXN0cm8oKTtcbmNvbnNvbGUubG9nKFwiLS0tLS0tLS0tLS1cIik7XG5cbi8qKlxuICog5aaC5p6c55So5pWj5YiX5p2l5a2Y5YKo5pWw5o2uXG4gKiDpgqPkuYjmr4/kuKrmlbDmja7lsLHlv4XpobvopoHopoHkuIDkuKrkuLvplK4g5p2l5L2c5Li6a2V5XG4gKiAqL1xuY2xhc3MgSGFzaFRhYmxlRGF0YTxUID0gYW55PiB7XG4gIHRhYmxlOiBUW10gPSBuZXcgQXJyYXkoMTM3KTtcblxuICBzaW1wbGVIYXNoKGRhdGE6IHN0cmluZykge1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0b3RhbCArPSBkYXRhLmNoYXJDb2RlQXQoaSk7XG4gICAgfVxuICAgIHJldHVybiB0b3RhbCAlIHRoaXMudGFibGUubGVuZ3RoO1xuICB9XG5cbiAgLy8g6ZyN57qz566X5rOVIOabtOWlveeahOino+WGs+eisOaSnlxuICBiZXR0ZXJIYXNoKHN0cmluZzogc3RyaW5nKSB7XG4gICAgY29uc3QgSCA9IDMxO1xuICAgIGxldCB0b3RhbCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJpbmcubGVuZ3RoOyArK2kpIHtcbiAgICAgIHRvdGFsICs9IEggKiB0b3RhbCArIHN0cmluZy5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICB0b3RhbCA9IHRvdGFsICUgdGhpcy50YWJsZS5sZW5ndGg7XG4gICAgaWYgKHRvdGFsIDwgMCkge1xuICAgICAgdG90YWwgKz0gdGhpcy50YWJsZS5sZW5ndGggLSAxO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5mbG9vcih0b3RhbCk7XG4gIH1cblxuICAvLyDlgqjlrZjkuIDkuKrmlbDmja5cbiAgcHV0KGtleTogc3RyaW5nLCBkYXRhOiBUKSB7XG4gICAgY29uc3QgcG9zID0gdGhpcy5iZXR0ZXJIYXNoKGtleSk7XG4gICAgdGhpcy50YWJsZVtwb3NdID0gZGF0YTtcbiAgfVxuXG4gIGdldChrZXk6IHN0cmluZykge1xuICAgIHJldHVybiB0aGlzLnRhYmxlW3RoaXMuYmV0dGVySGFzaChrZXkpXTtcbiAgfVxuXG4gIC8vIOaJk+WNsOaJgOacieaVsOaNrlxuICBzaG93RGlzdHJvKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50YWJsZS5sZW5ndGg7ICsraSkge1xuICAgICAgaWYgKHRoaXMudGFibGVbaV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGkgKyBcIiA6IFwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy50YWJsZVtpXSkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBURCA9IG5ldyBIYXNoVGFibGVEYXRhKCk7XG5jb25zdCBkYXRhID0geyBrZXk6IFwiMTIzXCIsIHZhbHVlOiBcImFiY1wiIH07XG5URC5wdXQoZGF0YS5rZXksIGRhdGEpO1xuVEQuc2hvd0Rpc3RybygpO1xuXG5leHBvcnQge307XG4iXX0=