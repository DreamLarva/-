"use strict";
/**
 * 散列是一种常用的数据存储技术，散列后的数据可以快速地插入或取用。
 * 也可称为散列表 或者 哈希表
 * 散列使用的数据结构叫做散列表。
 * 在散列表上插入、删除和取用数据都非常快，但是对于查找操作来说却效率低下，比如查找一组数据中的最大值和最小值。
 * */
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * 散列表是基于数组进行设计的。
 * 数组的长度是预先设定的，如有需要，可以随时增加。
 * 所有元素根据和该元素对应的键，保存在数组的特定位置，该键和我们前面讲到的字典中的键是类似的概念。
 * 使用散列表存储数据时，通过一个散列函数将键映射为一个数字，这个数字的范围是 0 到散列表的长度。
 * 理想情况下，散列函数会将每个键值映射为一个唯一的数组索引。
 * 然而，键的数量是无限的，数组的长度是有限的（理论上，在 JavaScript 中是这样），
 * 一个更现实的目标是让散列函数尽量将键均匀地映射到数组中。
 * 即使使用一个高效的散列函数，仍然存在将两个键映射成同一个值的可能，这种现象称为碰撞（collision）。
 * 要确定的最后一个问题是：散列表中的数组究竟应该有多大？这是编写散列函数时必须要考虑的。
 * 对数组大小常见的限制是：数组长度应该是一个质数。
 * */
class HashTable {
    constructor() {
        this.table = new Array(137);
    }
    simpleHash(data) {
        let total = 0;
        for (let i = 0; i < data.length; i++) {
            total += data.charCodeAt(i);
        }
        return total % this.table.length;
    }
    ;
    put(data) {
        const pos = this.betterHash(data);
        this.table[pos] = data;
    }
    ;
    // 霍纳算法 更好的解决碰撞
    betterHash(string) {
        const H = 31;
        let total = 0;
        for (let i = 0; i < string.length; ++i) {
            total += H * total + string.charCodeAt(i);
        }
        total = total % this.table.length;
        if (total < 0) {
            total += this.table.length - 1;
        }
        return Math.floor(total);
    }
    ;
    putArr(arr) {
        arr.forEach(v => {
            const pos = this.betterHash(v);
            this.table[pos] = v;
            // console.log(pos, v);
        });
    }
    ;
    showDistro() {
        for (let i = 0; i < this.table.length; ++i) {
            if (this.table[i] != undefined) {
                console.log(i + " : " + this.table[i]);
            }
        }
    }
    ;
}
const T = new HashTable();
T.putArr(["David", "Jennifer", "Donnie", "Raymond", "Cynthia", "Mike", "Clayton", "Danny", "Jonathan"]);
T.showDistro();
console.log('-----------');
/**
 * 如果用散列来存储数据
 * 那么每个数据就必须要要一个主键 来作为key
 * */
class HashTableData {
    constructor() {
        this.table = new Array(137);
    }
    simpleHash(data) {
        let total = 0;
        for (let i = 0; i < data.length; i++) {
            total += data.charCodeAt(i);
        }
        return total % this.table.length;
    }
    ;
    // 霍纳算法 更好的解决碰撞
    betterHash(string) {
        const H = 31;
        let total = 0;
        for (let i = 0; i < string.length; ++i) {
            total += H * total + string.charCodeAt(i);
        }
        total = total % this.table.length;
        if (total < 0) {
            total += this.table.length - 1;
        }
        return Math.floor(total);
    }
    ;
    // 储存一个数据
    put(key, data) {
        const pos = this.betterHash(key);
        this.table[pos] = data;
    }
    ;
    get(key) {
        return this.table[this.betterHash(key)];
    }
    ;
    // 打印所有数据
    showDistro() {
        for (let i = 0; i < this.table.length; ++i) {
            if (this.table[i] != undefined) {
                console.log(i + " : " + JSON.stringify(this.table[i]));
            }
        }
    }
    ;
}
const TD = new HashTableData();
const data = { key: "123", value: "abc" };
TD.put(data.key, data);
TD.showDistro();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoi5pWj5YiXLmpzIiwic291cmNlUm9vdCI6Ii4vIiwic291cmNlcyI6WyLmlbDmja7nu5PmnoQv5pWj5YiXLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7S0FLSzs7QUFFTDs7Ozs7Ozs7Ozs7S0FXSztBQUVMLE1BQU0sU0FBUztJQUFmO1FBQ0ksVUFBSyxHQUFhLElBQUksS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBOENyQyxDQUFDO0lBNUNHLFVBQVUsQ0FBQyxJQUFZO1FBQ25CLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztRQUNkLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ2xDLEtBQUssSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQy9CO1FBQ0QsT0FBTyxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFDckMsQ0FBQztJQUFBLENBQUM7SUFHRixHQUFHLENBQUMsSUFBWTtRQUNaLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUM7SUFDM0IsQ0FBQztJQUFBLENBQUM7SUFFRixlQUFlO0lBQ2YsVUFBVSxDQUFDLE1BQWM7UUFDckIsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQ2IsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLEVBQUU7WUFDcEMsS0FBSyxJQUFJLENBQUMsR0FBRyxLQUFLLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUM3QztRQUNELEtBQUssR0FBRyxLQUFLLEdB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LEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQztJQUMzQixDQUFDO0lBQUEsQ0FBQztJQUVGLEdBQUcsQ0FBQyxHQUFXO1FBQ1gsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBQUEsQ0FBQztJQUVGLFNBQVM7SUFDVCxVQUFVO1FBQ04sS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxFQUFFO1lBQ3hDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxTQUFTLEVBQUU7Z0JBQzVCLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQzFEO1NBQ0o7SUFDTCxDQUFDO0lBQUEsQ0FBQztDQUNMO0FBR0QsTUFBTSxFQUFFLEdBQUcsSUFBSSxhQUFhLEVBQUUsQ0FBQztBQUMvQixNQUFNLElBQUksR0FBRyxFQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDO0FBQ3hDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztBQUN2QixFQUFFLENBQUMsVUFBVSxFQUFFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog5pWj5YiX5piv5LiA56eN5bi455So55qE5pWw5o2u5a2Y5YKo5oqA5pyv77yM5pWj5YiX5ZCO55qE5pWw5o2u5Y+v5Lul5b+r6YCf5Zyw5o+S5YWl5oiW5Y+W55So44CCXHJcbiAqIOS5n+WPr+ensOS4uuaVo+WIl+ihqCDmiJbogIUg5ZOI5biM6KGoXHJcbiAqIOaVo+WIl+S9v+eUqOeahOaVsOaNrue7k+aehOWPq+WBmuaVo+WIl+ihqOOAglxyXG4gKiDlnKjmlaPliJfooajkuIrmj5LlhaXjgIHliKDpmaTlkozlj5bnlKjmlbDmja7pg73pnZ7luLjlv6vvvIzkvYbmmK/lr7nkuo7mn6Xmib7mk43kvZzmnaXor7TljbTmlYjnjofkvY7kuIvvvIzmr5TlpoLmn6Xmib7kuIDnu4TmlbDmja7kuK3nmoTmnIDlpKflgLzlkozmnIDlsI/lgLzjgIJcclxuICogKi9cclxuXHJcbi8qKlxyXG4gKiDmlaPliJfooajmmK/ln7rkuo7mlbDnu4Tov5vooYzorr7orqHnmoTjgIJcclxuICog5pWw57uE55qE6ZW/5bqm5piv6aKE5YWI6K6+5a6a55qE77yM5aaC5pyJ6ZyA6KaB77yM5Y+v5Lul6ZqP5pe25aKe5Yqg44CCXHJcbiAqIOaJgOacieWFg+e0oOagueaNruWSjOivpeWFg+e0oOWvueW6lOeahOmUru+8jOS/neWtmOWcqOaVsOe7hOeahOeJueWumuS9jee9ru+8jOivpemUruWSjOaIkeS7rOWJjemdouiusuWIsOeahOWtl+WFuOS4reeahOmUruaYr+exu+S8vOeahOamguW/teOAglxyXG4gKiDkvb/nlKjmlaPliJfooajlrZjlgqjmlbDmja7ml7bvvIzpgJrov4fkuIDkuKrmlaPliJflh73mlbDlsIbplK7mmKDlsITkuLrkuIDkuKrmlbDlrZfvvIzov5nkuKrmlbDlrZfnmoTojIPlm7TmmK8gMCDliLDmlaPliJfooajnmoTplb/luqbjgIJcclxuICog55CG5oOz5oOF5Ya15LiL77yM5pWj5YiX5Ye95pWw5Lya5bCG5q+P5Liq6ZSu5YC85pig5bCE5Li65LiA5Liq5ZSv5LiA55qE5pWw57uE57Si5byV44CCXHJcbiAqIOeEtuiAjO+8jOmUrueahOaVsOmHj+aYr+aXoOmZkOeahO+8jOaVsOe7hOeahOmVv+W6puaYr+aciemZkOeahO+8iOeQhuiuuuS4iu+8jOWcqCBKYXZhU2NyaXB0IOS4reaYr+i/meagt++8ie+8jFxyXG4gKiDkuIDkuKrmm7TnjrDlrp7nmoTnm67moIfmmK/orqnmlaPliJflh73mlbDlsL3ph4/lsIbplK7lnYfljIDlnLDmmKDlsITliLDmlbDnu4TkuK3jgIJcclxuICog5Y2z5L2/5L2/55So5LiA5Liq6auY5pWI55qE5pWj5YiX5Ye95pWw77yM5LuN54S25a2Y5Zyo5bCG5Lik5Liq6ZSu5pig5bCE5oiQ5ZCM5LiA5Liq5YC855qE5Y+v6IO977yM6L+Z56eN546w6LGh56ew5Li656Kw5pKe77yIY29sbGlzaW9u77yJ44CCXHJcbiAqIOimgeehruWumueahOacgOWQjuS4gOS4qumXrumimOaYr++8muaVo+WIl+ihqOS4reeahOaVsOe7hOeptuern+W6lOivpeacieWkmuWkp++8n+i/meaYr+e8luWGmeaVo+WIl+WHveaVsOaXtuW/hemhu+imgeiAg+iZkeeahOOAglxyXG4gKiDlr7nmlbDnu4TlpKflsI/luLjop4HnmoTpmZDliLbmmK/vvJrmlbDnu4Tplb/luqblupTor6XmmK/kuIDkuKrotKjmlbDjgIJcclxuICogKi9cclxuXHJcbmNsYXNzIEhhc2hUYWJsZSB7XHJcbiAgICB0YWJsZTogc3RyaW5nW10gPSBuZXcgQXJyYXkoMTM3KTtcclxuXHJcbiAgICBzaW1wbGVIYXNoKGRhdGE6IHN0cmluZykge1xyXG4gICAgICAgIGxldCB0b3RhbCA9IDA7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRvdGFsICs9IGRhdGEuY2hhckNvZGVBdChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRvdGFsICUgdGhpcy50YWJsZS5sZW5ndGg7XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICBwdXQoZGF0YTogc3RyaW5nKSB7IC8vIOWCqOWtmOS4gOS4quaVsOaNrlxyXG4gICAgICAgIGNvbnN0IHBvcyA9IHRoaXMuYmV0dGVySGFzaChkYXRhKTtcclxuICAgICAgICB0aGlzLnRhYmxlW3Bvc10gPSBkYXRhO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyDpnI3nurPnrpfms5Ug5pu05aW955qE6Kej5Yaz56Kw5pKeXHJcbiAgICBiZXR0ZXJIYXNoKHN0cmluZzogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgSCA9IDMxO1xyXG4gICAgICAgIGxldCB0b3RhbCA9IDA7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJpbmcubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgdG90YWwgKz0gSCAqIHRvdGFsICsgc3RyaW5nLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRvdGFsID0gdG90YWwgJSB0aGlzLnRhYmxlLmxlbmd0aDtcclxuICAgICAgICBpZiAodG90YWwgPCAwKSB7XHJcbiAgICAgICAgICAgIHRvdGFsICs9IHRoaXMudGFibGUubGVuZ3RoIC0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IodG90YWwpO1xyXG4gICAgfTtcclxuXHJcbiAgICBwdXRBcnIoYXJyOiBzdHJpbmdbXSkgeyAvLyDlgqjlrZjlpJrkuKrmlbDmja5cclxuICAgICAgICBhcnIuZm9yRWFjaCh2ID0+IHsgLy8g566t5aS05Ye95pWw57uR5a6a5LqG5L2c55So5Z+fXHJcbiAgICAgICAgICAgIGNvbnN0IHBvcyA9IHRoaXMuYmV0dGVySGFzaCh2KTtcclxuICAgICAgICAgICAgdGhpcy50YWJsZVtwb3NdID0gdjtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocG9zLCB2KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHNob3dEaXN0cm8oKSB7IC8vIOaJk+WNsOaJgOacieaVsOaNrlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50YWJsZS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50YWJsZVtpXSAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGkgKyBcIiA6IFwiICsgdGhpcy50YWJsZVtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5cclxuY29uc3QgVCA9IG5ldyBIYXNoVGFibGUoKTtcclxuVC5wdXRBcnIoW1wiRGF2aWRcIiwgXCJKZW5uaWZlclwiLCBcIkRvbm5pZVwiLCBcIlJheW1vbmRcIiwgXCJDeW50aGlhXCIsIFwiTWlrZVwiLCBcIkNsYXl0b25cIiwgXCJEYW5ueVwiLCBcIkpvbmF0aGFuXCJdKTtcclxuVC5zaG93RGlzdHJvKCk7XHJcbmNvbnNvbGUubG9nKCctLS0tLS0tLS0tLScpO1xyXG5cclxuXHJcbi8qKlxyXG4gKiDlpoLmnpznlKjmlaPliJfmnaXlrZjlgqjmlbDmja5cclxuICog6YKj5LmI5q+P5Liq5pWw5o2u5bCx5b+F6aG76KaB6KaB5LiA5Liq5Li76ZSuIOadpeS9nOS4umtleVxyXG4gKiAqL1xyXG5jbGFzcyBIYXNoVGFibGVEYXRhPFQgPSBhbnk+IHtcclxuICAgIHRhYmxlOiBUW10gPSBuZXcgQXJyYXkoMTM3KTtcclxuXHJcbiAgICBzaW1wbGVIYXNoKGRhdGE6IHN0cmluZykge1xyXG4gICAgICAgIGxldCB0b3RhbCA9IDA7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRvdGFsICs9IGRhdGEuY2hhckNvZGVBdChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRvdGFsICUgdGhpcy50YWJsZS5sZW5ndGg7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIOmcjee6s+eul+azlSDmm7Tlpb3nmoTop6PlhrPnorDmkp5cclxuICAgIGJldHRlckhhc2goc3RyaW5nOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBIID0gMzE7XHJcbiAgICAgICAgbGV0IHRvdGFsID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0cmluZy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB0b3RhbCArPSBIICogdG90YWwgKyBzdHJpbmcuY2hhckNvZGVBdChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdG90YWwgPSB0b3RhbCAlIHRoaXMudGFibGUubGVuZ3RoO1xyXG4gICAgICAgIGlmICh0b3RhbCA8IDApIHtcclxuICAgICAgICAgICAgdG90YWwgKz0gdGhpcy50YWJsZS5sZW5ndGggLSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih0b3RhbCk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIOWCqOWtmOS4gOS4quaVsOaNrlxyXG4gICAgcHV0KGtleTogc3RyaW5nLCBkYXRhOiBUKSB7XHJcbiAgICAgICAgY29uc3QgcG9zID0gdGhpcy5iZXR0ZXJIYXNoKGtleSk7XHJcbiAgICAgICAgdGhpcy50YWJsZVtwb3NdID0gZGF0YTtcclxuICAgIH07XHJcblxyXG4gICAgZ2V0KGtleTogc3RyaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGFibGVbdGhpcy5iZXR0ZXJIYXNoKGtleSldO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyDmiZPljbDmiYDmnInmlbDmja5cclxuICAgIHNob3dEaXN0cm8oKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRhYmxlLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnRhYmxlW2ldICE9IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaSArIFwiIDogXCIgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnRhYmxlW2ldKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5cclxuY29uc3QgVEQgPSBuZXcgSGFzaFRhYmxlRGF0YSgpO1xyXG5jb25zdCBkYXRhID0ge2tleTogXCIxMjNcIiwgdmFsdWU6IFwiYWJjXCJ9O1xyXG5URC5wdXQoZGF0YS5rZXksIGRhdGEpO1xyXG5URC5zaG93RGlzdHJvKCk7XHJcblxyXG5leHBvcnQge31cclxuIl19