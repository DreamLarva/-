"use strict";
/*
统计所有小于非负整数 n 的质数的数量。

示例:

输入: 10
输出: 4
解释: 小于 10 的质数一共有 4 个, 它们是 2, 3, 5, 7 。
* */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * 厄拉多塞筛法.
 * 比如说求20以内质数的个数,首先0,1不是质数.2是第一个质数,然后把20以内所有2的倍数划去.
 * 2后面紧跟的数即为下一个质数3,然后把3所有的倍数划去.3后面紧跟的数即为下一个质数5,再把5所有的倍数划去.以此类推.
 * */
/**
 * @param {number} n
 * @return {number}
 */
var countPrimes = function (n) {
    const primeCache = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97];
    if (n <= 100) {
        let index = 0;
        while (n > primeCache[index]) {
            index++;
        }
        return index;
    }
    const excludeCache = new Set();
    for (const num of primeCache) {
        saveExclude(excludeCache, num, n);
    }
    let result = primeCache.length;
    for (let num = 101; num < n; num++) {
        if (excludeCache.has(num))
            continue;
        if (isPrime(num)) {
            saveExclude(excludeCache, num, n);
            result++;
        }
    }
    return result;
};
function saveExclude(set, num, n) {
    if (num < 100) {
        num = Math.ceil(100 / num) * num;
    }
    while (n >= num) {
        set.add(num);
        num += num;
    }
}
function isPrime(n) {
    if (n <= 3)
        return n > 1;
    if (n % 2 === 0 || n % 3 === 0)
        return false;
    for (let i = 5; i * i <= n; i += 6) {
        if (n % i === 0 || n % (i + 2) === 0) {
            return false;
        }
    }
    return true;
}
const assert_1 = __importDefault(require("assert"));
assert_1.default.strictEqual(countPrimes(2), 0);
assert_1.default.strictEqual(countPrimes(3), 1);
assert_1.default.strictEqual(countPrimes(6), 3);
assert_1.default.strictEqual(countPrimes(100), 25);
assert_1.default.strictEqual(countPrimes(105), 27);
assert_1.default.strictEqual(countPrimes(121), 30);
var countPrimes2 = function (n) {
    // 使用数组
    let notPrimes = new Uint8Array(n);
    let count = 0;
    for (let i = 2; i < n; i++) {
        if (notPrimes[i] !== 1) {
            count++;
            let a = n / i;
            for (let j = i; j < a; j++) {
                notPrimes[i * j] = 1;
            }
        }
    }
    return count;
};
assert_1.default.strictEqual(countPrimes2(2), 0);
assert_1.default.strictEqual(countPrimes2(3), 1);
assert_1.default.strictEqual(countPrimes2(6), 3);
assert_1.default.strictEqual(countPrimes2(100), 25);
assert_1.default.strictEqual(countPrimes2(105), 27);
assert_1.default.strictEqual(countPrimes2(121), 30);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjA0LuiuoeaVsOi0qOaVsC5qcyIsInNvdXJjZVJvb3QiOiIuLyIsInNvdXJjZXMiOlsibGVldGNvZGUvMjA0LuiuoeaVsOi0qOaVsC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7O0lBUUk7Ozs7O0FBRUo7Ozs7S0FJSztBQUNMOzs7R0FHRztBQUNILElBQUksV0FBVyxHQUFHLFVBQVUsQ0FBUztJQUNqQyxNQUFNLFVBQVUsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBRXBILElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRTtRQUNWLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQztRQUNkLE9BQU8sQ0FBQyxHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUMxQixLQUFLLEVBQUUsQ0FBQztTQUNYO1FBQ0QsT0FBTyxLQUFLLENBQUM7S0FDaEI7SUFDRCxNQUFNLFlBQVksR0FBZSxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBQzNDLEtBQUssTUFBTSxHQUFHLElBQUksVUFBVSxFQUFFO1FBQzFCLFdBQVcsQ0FBQyxZQUFZLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO0tBQ3JDO0lBR0QsSUFBSSxNQUFNLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQztJQUMvQixLQUFLLElBQUksR0FBRyxHQUFHLEdBQUcsRUFBRSxHQUFHLEdBQUcsQ0FBQyxFQUFFLEdBQUcsRUFBRSxFQUFFO1FBQ2hDLElBQUksWUFB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QUFDLENBQUMsQ0FBQztBQUN2QyxnQkFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDdkMsZ0JBQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3ZDLGdCQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztBQUMxQyxnQkFBTSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDMUMsZ0JBQU0sQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxu57uf6K6h5omA5pyJ5bCP5LqO6Z2e6LSf5pW05pWwIG4g55qE6LSo5pWw55qE5pWw6YeP44CCXHJcblxyXG7npLrkvos6XHJcblxyXG7ovpPlhaU6IDEwXHJcbui+k+WHujogNFxyXG7op6Pph4o6IOWwj+S6jiAxMCDnmoTotKjmlbDkuIDlhbHmnIkgNCDkuKosIOWug+S7rOaYryAyLCAzLCA1LCA3IOOAglxyXG4qICovXHJcblxyXG4vKipcclxuICog5Y6E5ouJ5aSa5aGe562b5rOVLlxyXG4gKiDmr5TlpoLor7TmsYIyMOS7peWGhei0qOaVsOeahOS4quaVsCzpppblhYgwLDHkuI3mmK/otKjmlbAuMuaYr+esrOS4gOS4qui0qOaVsCznhLblkI7miooyMOS7peWGheaJgOaciTLnmoTlgI3mlbDliJLljrsuXHJcbiAqIDLlkI7pnaLntKfot5/nmoTmlbDljbPkuLrkuIvkuIDkuKrotKjmlbAzLOeEtuWQjuaKijPmiYDmnInnmoTlgI3mlbDliJLljrsuM+WQjumdoue0p+i3n+eahOaVsOWNs+S4uuS4i+S4gOS4qui0qOaVsDUs5YaN5oqKNeaJgOacieeahOWAjeaVsOWIkuWOuy7ku6XmraTnsbvmjqguXHJcbiAqICovXHJcbi8qKlxyXG4gKiBAcGFyYW0ge251bWJlcn0gblxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAqL1xyXG52YXIgY291bnRQcmltZXMgPSBmdW5jdGlvbiAobjogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBwcmltZUNhY2hlID0gWzIsIDMsIDUsIDcsIDExLCAxMywgMTcsIDE5LCAyMywgMjksIDMxLCAzNywgNDEsIDQzLCA0NywgNTMsIDU5LCA2MSwgNjcsIDcxLCA3MywgNzksIDgzLCA4OSwgOTddO1xyXG5cclxuICAgIGlmIChuIDw9IDEwMCkge1xyXG4gICAgICAgIGxldCBpbmRleCA9IDA7XHJcbiAgICAgICAgd2hpbGUgKG4gPiBwcmltZUNhY2hlW2luZGV4XSkge1xyXG4gICAgICAgICAgICBpbmRleCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5kZXg7XHJcbiAgICB9XHJcbiAgICBjb25zdCBleGNsdWRlQ2FjaGU6U2V0PG51bWJlcj4gPSBuZXcgU2V0KCk7XHJcbiAgICBmb3IgKGNvbnN0IG51bSBvZiBwcmltZUNhY2hlKSB7XHJcbiAgICAgICAgc2F2ZUV4Y2x1ZGUoZXhjbHVkZUNhY2hlLCBudW0sIG4pO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBsZXQgcmVzdWx0ID0gcHJpbWVDYWNoZS5sZW5ndGg7XHJcbiAgICBmb3IgKGxldCBudW0gPSAxMDE7IG51bSA8IG47IG51bSsrKSB7XHJcbiAgICAgICAgaWYgKGV4Y2x1ZGVDYWNoZS5oYXMobnVtKSkgY29udGludWU7XHJcblxyXG4gICAgICAgIGlmIChpc1ByaW1lKG51bSkpIHtcclxuICAgICAgICAgICAgc2F2ZUV4Y2x1ZGUoZXhjbHVkZUNhY2hlLCBudW0sIG4pO1xyXG4gICAgICAgICAgICByZXN1bHQrKztcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG5cclxuXHJcbn07XHJcblxyXG5mdW5jdGlvbiBzYXZlRXhjbHVkZShzZXQ6IFNldDxudW1iZXI+LCBudW06IG51bWJlciwgbjogbnVtYmVyKSB7XHJcbiAgICBpZiAobnVtIDwgMTAwKSB7XHJcbiAgICAgICAgbnVtID0gTWF0aC5jZWlsKDEwMCAvIG51bSkgKiBudW07XHJcbiAgICB9XHJcbiAgICB3aGlsZSAobiA+PSBudW0pIHtcclxuICAgICAgICBzZXQuYWRkKG51bSk7XHJcbiAgICAgICAgbnVtICs9IG51bTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBpc1ByaW1lKG46IG51bWJlcikge1xyXG4gICAgaWYgKG4gPD0gMykgcmV0dXJuIG4gPiAxO1xyXG4gICAgaWYgKG4gJSAyID09PSAwIHx8IG4gJSAzID09PSAwKSByZXR1cm4gZmFsc2U7XHJcbiAgICBmb3IgKGxldCBpID0gNTsgaSAqIGkgPD0gbjsgaSArPSA2KSB7XHJcbiAgICAgICAgaWYgKG4gJSBpID09PSAwIHx8IG4gJSAoaSArIDIpID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuaW1wb3J0IGFzc2VydCBmcm9tIFwiYXNzZXJ0XCI7XHJcblxyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMoMiksIDApO1xyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMoMyksIDEpO1xyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMoNiksIDMpO1xyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMoMTAwKSwgMjUpO1xyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMoMTA1KSwgMjcpO1xyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMoMTIxKSwgMzApO1xyXG5cclxudmFyIGNvdW50UHJpbWVzMiA9IGZ1bmN0aW9uIChuOiBudW1iZXIpIHtcclxuICAgIC8vIOS9v+eUqOaVsOe7hFxyXG4gICAgbGV0IG5vdFByaW1lcyA9IG5ldyBVaW50OEFycmF5KG4pO1xyXG4gICAgbGV0IGNvdW50ID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAyOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgaWYgKG5vdFByaW1lc1tpXSAhPT0gMSkge1xyXG4gICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICBsZXQgYSA9IG4gLyBpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gaTsgaiA8IGE7IGorKykge1xyXG4gICAgICAgICAgICAgICAgbm90UHJpbWVzW2kgKiBqXSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY291bnQ7XHJcbn07XHJcblxyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMyKDIpLCAwKTtcclxuYXNzZXJ0LnN0cmljdEVxdWFsKGNvdW50UHJpbWVzMigzKSwgMSk7XHJcbmFzc2VydC5zdHJpY3RFcXVhbChjb3VudFByaW1lczIoNiksIDMpO1xyXG5hc3NlcnQuc3RyaWN0RXF1YWwoY291bnRQcmltZXMyKDEwMCksIDI1KTtcclxuYXNzZXJ0LnN0cmljdEVxdWFsKGNvdW50UHJpbWVzMigxMDUpLCAyNyk7XHJcbmFzc2VydC5zdHJpY3RFcXVhbChjb3VudFByaW1lczIoMTIxKSwgMzApO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==