"use strict";
/*
40. 组合总和 II

给定一个数组 candidates 和一个目标数 target ，找出 candidates 中所有可以使数字和为 target 的组合。

candidates 中的每个数字在每个组合中只能使用一次。

说明：

所有数字（包括目标数）都是正整数。
解集不能包含重复的组合。
示例 1:

输入: candidates = [10,1,2,7,6,1,5], target = 8,
所求解集为:
[
  [1, 7],
  [1, 2, 5],
  [2, 6],
  [1, 1, 6]
]
示例 2:

输入: candidates = [2,5,2,1,2], target = 5,
所求解集为:
[
  [1,2,2],
  [5]
]

来源：力扣（LeetCode）
链接：https://leetcode-cn.com/problems/combination-sum-ii
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
* */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
function combinationSum2(candidates, target) {
    const sortedData = sortData(candidates);
    const result = [];
    dfs(target, 0, sortedData);
    return result;
    function dfs(rest, position = 0, restList, resultList = []) {
        if (rest === 0) {
            result.push(resultList);
            return;
        }
        if (rest < 0)
            return;
        if (restList[position] == null)
            return;
        const [val, time] = restList[position++];
        for (let i = 0; i <= time; i++) {
            dfs(rest - i * val, position, restList, resultList.concat(...Array(i).fill(val)));
        }
    }
}
/**
 * 先整理数据 , 相同的整理到一起
 * */
function sortData(candidates) {
    let index = 0;
    const data = [];
    const map = {};
    for (let i = 0; i < candidates.length; i++) {
        const cur = candidates[i];
        if (map[cur] != null) {
            data[map[cur]][1]++;
        }
        else {
            map[cur] = index;
            data.push([cur, 1]);
            index++;
        }
    }
    return data;
}
function combinationSum3(candidates, target) {
    candidates.sort((a, b) => a - b);
    const result = [];
    dfs(0, target);
    return result;
    function dfs(position, target, status = []) {
        if (target < 0)
            return;
        if (target === 0) {
            result.push(status.slice());
            return;
        }
        if (position >= candidates.length)
            return;
        let last = NaN;
        for (let i = position; i < candidates.length; i++) {
            // 妙啊
            // 保证了 本地的这次循环 相同的值只可能出现一次
            if (last === candidates[i])
                continue;
            // 当前值为
            last = candidates[i];
            status.push(candidates[i]);
            dfs(i + 1, target - candidates[i], status);
            // 将进入没有 candidates[i] 的流程
            status.pop();
        }
    }
}
const assert_1 = __importDefault(require("assert"));
const assertHelper_1 = require("../util/assertHelper");
assert_1.default.deepStrictEqual((0, assertHelper_1.sortDeep)(combinationSum2([10, 1, 2, 7, 6, 1, 5], 8)), (0, assertHelper_1.sortDeep)([
    [1, 7],
    [1, 2, 5],
    [2, 6],
    [1, 1, 6],
]));
assert_1.default.deepStrictEqual((0, assertHelper_1.sortDeep)(combinationSum2([2, 5, 2, 1, 2], 5)), (0, assertHelper_1.sortDeep)([[1, 2, 2], [5]]));
assert_1.default.deepStrictEqual((0, assertHelper_1.sortDeep)(combinationSum2([1, 1], 1)), (0, assertHelper_1.sortDeep)([[1]]));
assert_1.default.deepStrictEqual((0, assertHelper_1.sortDeep)(combinationSum3([10, 1, 2, 7, 6, 1, 5], 8)), (0, assertHelper_1.sortDeep)([
    [1, 7],
    [1, 2, 5],
    [2, 6],
    [1, 1, 6],
]));
assert_1.default.deepStrictEqual((0, assertHelper_1.sortDeep)(combinationSum3([2, 5, 2, 1, 2], 5)), (0, assertHelper_1.sortDeep)([[1, 2, 2], [5]]));
assert_1.default.deepStrictEqual((0, assertHelper_1.sortDeep)(combinationSum3([1, 1], 1)), (0, assertHelper_1.sortDeep)([[1]]));
const benchmark_1 = __importDefault(require("benchmark"));
const suite = new benchmark_1.default.Suite();
const candidates = [1, 1];
const target = 1; // Math.floor(Math.random() * 100);
console.log(target);
suite
    .add("sort and dfs", function () {
    combinationSum2(candidates, target);
})
    .add("dfs", function () {
    combinationSum3(candidates, target);
})
    .on("cycle", function (event) {
    console.log(String(event.target));
})
    .on("complete", function () {
    // console.log('Fastest is ' + this.filter('fastest').map( 'name'));
})
    // run async
    .run({ async: false });
/**
 * combinationSum3 不整理数据的 快的多
 * */
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDAu57uE5ZCI5oC75ZKMSUkuanMiLCJzb3VyY2VSb290IjoiLi8iLCJzb3VyY2VzIjpbImxlZXRjb2RlLzQwLue7hOWQiOaAu+WSjElJLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBaUNJOzs7OztBQUVKLFNBQVMsZUFBZSxDQUFDLFVBQW9CLEVBQUUsTUFBYztJQUMzRCxNQUFNLFVBQVUsR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDeEMsTUFBTSxNQUFNLEdBQWUsRUFBRSxDQUFDO0lBQzlCLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQzNCLE9BQU8sTUFBTSxDQUFDO0lBRWQsU0FBUyxHQUFHLENBQ1YsSUFBWSxFQUNaLFFBQVEsR0FBRyxDQUFDLEVBQ1osUUFBNEIsRUFDNUIsYUFBdUIsRUFBRTtRQUV6QixJQUFJLElBQUksS0FBSyxDQUFDLEVBQUU7WUFDZCxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3hCLE9BQU87U0FDUjtRQUNELElBQUksSUFBSSxHQUFHLENBQUM7WUFBRSxPQUFPO1FBQ3JCLElBQUksUUFBUSxDQUFDLFFBQVEsQ0FBQyxJQUFJLElBQUk7WUFBRSxPQUFPO1FBQ3ZDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUcsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7UUFFekMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUM5QixHQUFHLENBQ0QsSUFBSSxHQUFHLENBQUMsR0FBRyxHQUFHLEVBQ2QsUUFBUSxFQUNSLFFBQVEsRUFDUixVQUFVLENBQUMsTUFBTSxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUN6QyxDQUFD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QUM7Q0FDVixDQUFDLENBQ0gsQ0FBQztBQUNGLGdCQUFNLENBQUMsZUFBZSxDQUNwQixJQUFBLHVCQUFRLEVBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQzdDLElBQUEsdUJBQVEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDM0IsQ0FBQztBQUNGLGdCQUFNLENBQUMsZUFBZSxDQUFDLElBQUEsdUJBQVEsRUFBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFBLHVCQUFRLEVBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBRTlFLGdCQUFNLENBQUMsZUFBZSxDQUNwQixJQUFBLHVCQUFRLEVBQUMsZUFBZSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFDcEQsSUFBQSx1QkFBUSxFQUFDO0lBQ1AsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ04sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNULENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7Q0FDVixDQUFDLENBQ0gsQ0FBQztBQUNGLGdCQUFNLENBQUMsZUFBZSxDQUNwQixJQUFBLHVCQUFRLEVBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQzdDLElBQUEsdUJBQVEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDM0IsQ0FBQztBQUNGLGdCQUFNLENBQUMsZUFBZSxDQUFDLElBQUEsdUJBQVEsRUFBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFBLHVCQUFRLEVBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBRTlFLDBEQUFrQztBQUNsQyxNQUFNLEtBQUssR0FBRyxJQUFJLG1CQUFTLENBQUMsS0FBSyxFQUFFLENBQUM7QUFFcEMsTUFBTSxVQUFVLEdBQUcsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7QUFDekIsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFBLENBQUMsbUNBQW1DO0FBQ3BELE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUE7QUFFbkIsS0FBSztLQUNGLEdBQUcsQ0FBQyxjQUFjLEVBQUU7SUFDbkIsZUFBZSxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUN0QyxDQUFDLENBQUM7S0FDRCxHQUFHLENBQUMsS0FBSyxFQUFFO0lBQ1YsZUFBZSxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUN0QyxDQUFDLENBQUM7S0FDRCxFQUFFLENBQUMsT0FBTyxFQUFFLFVBQVUsS0FBc0I7SUFDM0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7QUFDcEMsQ0FBQyxDQUFDO0tBQ0QsRUFBRSxDQUFDLFVBQVUsRUFBRTtJQUNkLG9FQUFvRTtBQUN0RSxDQUFDLENBQUM7SUFDRixZQUFZO0tBQ1gsR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7QUFFekI7O0tBRUsiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuNDAuIOe7hOWQiOaAu+WSjCBJSVxuXG7nu5nlrprkuIDkuKrmlbDnu4QgY2FuZGlkYXRlcyDlkozkuIDkuKrnm67moIfmlbAgdGFyZ2V0IO+8jOaJvuWHuiBjYW5kaWRhdGVzIOS4reaJgOacieWPr+S7peS9v+aVsOWtl+WSjOS4uiB0YXJnZXQg55qE57uE5ZCI44CCXG5cbmNhbmRpZGF0ZXMg5Lit55qE5q+P5Liq5pWw5a2X5Zyo5q+P5Liq57uE5ZCI5Lit5Y+q6IO95L2/55So5LiA5qyh44CCXG5cbuivtOaYju+8mlxuXG7miYDmnInmlbDlrZfvvIjljIXmi6znm67moIfmlbDvvInpg73mmK/mraPmlbTmlbDjgIJcbuino+mbhuS4jeiDveWMheWQq+mHjeWkjeeahOe7hOWQiOOAglxu56S65L6LIDE6XG5cbui+k+WFpTogY2FuZGlkYXRlcyA9IFsxMCwxLDIsNyw2LDEsNV0sIHRhcmdldCA9IDgsXG7miYDmsYLop6Ppm4bkuLo6XG5bXG4gIFsxLCA3XSxcbiAgWzEsIDIsIDVdLFxuICBbMiwgNl0sXG4gIFsxLCAxLCA2XVxuXVxu56S65L6LIDI6XG5cbui+k+WFpTogY2FuZGlkYXRlcyA9IFsyLDUsMiwxLDJdLCB0YXJnZXQgPSA1LFxu5omA5rGC6Kej6ZuG5Li6OlxuW1xuICBbMSwyLDJdLFxuICBbNV1cbl1cblxu5p2l5rqQ77ya5Yqb5omj77yITGVldENvZGXvvIlcbumTvuaOpe+8mmh0dHBzOi8vbGVldGNvZGUtY24uY29tL3Byb2JsZW1zL2NvbWJpbmF0aW9uLXN1bS1paVxu6JGX5L2c5p2D5b2S6aKG5omj572R57uc5omA5pyJ44CC5ZWG5Lia6L2s6L296K+36IGU57O75a6Y5pa55o6I5p2D77yM6Z2e5ZWG5Lia6L2s6L296K+35rOo5piO5Ye65aSE44CCXG4qICovXG5cbmZ1bmN0aW9uIGNvbWJpbmF0aW9uU3VtMihjYW5kaWRhdGVzOiBudW1iZXJbXSwgdGFyZ2V0OiBudW1iZXIpOiBudW1iZXJbXVtdIHtcbiAgY29uc3Qgc29ydGVkRGF0YSA9IHNvcnREYXRhKGNhbmRpZGF0ZXMpO1xuICBjb25zdCByZXN1bHQ6IG51bWJlcltdW10gPSBbXTtcbiAgZGZzKHRhcmdldCwgMCwgc29ydGVkRGF0YSk7XG4gIHJldHVybiByZXN1bHQ7XG5cbiAgZnVuY3Rpb24gZGZzKFxuICAgIHJlc3Q6IG51bWJlcixcbiAgICBwb3NpdGlvbiA9IDAsXG4gICAgcmVzdExpc3Q6IFtudW1iZXIsIG51bWJlcl1bXSxcbiAgICByZXN1bHRMaXN0OiBudW1iZXJbXSA9IFtdXG4gICkge1xuICAgIGlmIChyZXN0ID09PSAwKSB7XG4gICAgICByZXN1bHQucHVzaChyZXN1bHRMaXN0KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHJlc3QgPCAwKSByZXR1cm47XG4gICAgaWYgKHJlc3RMaXN0W3Bvc2l0aW9uXSA9PSBudWxsKSByZXR1cm47XG4gICAgY29uc3QgW3ZhbCwgdGltZV0gPSByZXN0TGlzdFtwb3NpdGlvbisrXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHRpbWU7IGkrKykge1xuICAgICAgZGZzKFxuICAgICAgICByZXN0IC0gaSAqIHZhbCxcbiAgICAgICAgcG9zaXRpb24sXG4gICAgICAgIHJlc3RMaXN0LFxuICAgICAgICByZXN1bHRMaXN0LmNvbmNhdCguLi5BcnJheShpKS5maWxsKHZhbCkpXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIOWFiOaVtOeQhuaVsOaNriAsIOebuOWQjOeahOaVtOeQhuWIsOS4gOi1t1xuICogKi9cbmZ1bmN0aW9uIHNvcnREYXRhKGNhbmRpZGF0ZXM6IG51bWJlcltdKSB7XG4gIGxldCBpbmRleCA9IDA7XG4gIGNvbnN0IGRhdGE6IFtudW1iZXIsIG51bWJlcl1bXSA9IFtdO1xuICBjb25zdCBtYXA6IHsgW2tleTogbnVtYmVyXTogbnVtYmVyIH0gPSB7fTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgY3VyID0gY2FuZGlkYXRlc1tpXTtcbiAgICBpZiAobWFwW2N1cl0gIT0gbnVsbCkge1xuICAgICAgZGF0YVttYXBbY3VyXV1bMV0rKztcbiAgICB9IGVsc2Uge1xuICAgICAgbWFwW2N1cl0gPSBpbmRleDtcbiAgICAgIGRhdGEucHVzaChbY3VyLCAxXSk7XG4gICAgICBpbmRleCsrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gY29tYmluYXRpb25TdW0zKGNhbmRpZGF0ZXM6IG51bWJlcltdLCB0YXJnZXQ6IG51bWJlcik6IG51bWJlcltdW10ge1xuICBjYW5kaWRhdGVzLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgY29uc3QgcmVzdWx0OiBudW1iZXJbXVtdID0gW107XG4gIGRmcygwLCB0YXJnZXQpO1xuICByZXR1cm4gcmVzdWx0O1xuXG4gIGZ1bmN0aW9uIGRmcyhwb3NpdGlvbjogbnVtYmVyLCB0YXJnZXQ6IG51bWJlciwgc3RhdHVzOiBudW1iZXJbXSA9IFtdKSB7XG4gICAgaWYgKHRhcmdldCA8IDApIHJldHVybjtcblxuICAgIGlmICh0YXJnZXQgPT09IDApIHtcbiAgICAgIHJlc3VsdC5wdXNoKHN0YXR1cy5zbGljZSgpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAocG9zaXRpb24gPj0gY2FuZGlkYXRlcy5sZW5ndGgpIHJldHVybjtcblxuICAgIGxldCBsYXN0ID0gTmFOO1xuICAgIGZvciAobGV0IGkgPSBwb3NpdGlvbjsgaSA8IGNhbmRpZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIOWmmeWVilxuICAgICAgLy8g5L+d6K+B5LqGIOacrOWcsOeahOi/measoeW+queOryDnm7jlkIznmoTlgLzlj6rlj6/og73lh7rnjrDkuIDmrKFcbiAgICAgIGlmIChsYXN0ID09PSBjYW5kaWRhdGVzW2ldKSBjb250aW51ZTtcblxuICAgICAgLy8g5b2T5YmN5YC85Li6XG4gICAgICBsYXN0ID0gY2FuZGlkYXRlc1tpXTtcbiAgICAgIHN0YXR1cy5wdXNoKGNhbmRpZGF0ZXNbaV0pO1xuICAgICAgZGZzKGkgKyAxLCB0YXJnZXQgLSBjYW5kaWRhdGVzW2ldLCBzdGF0dXMpO1xuXG4gICAgICAvLyDlsIbov5vlhaXmsqHmnIkgY2FuZGlkYXRlc1tpXSDnmoTmtYHnqItcbiAgICAgIHN0YXR1cy5wb3AoKTtcbiAgICB9XG4gIH1cbn1cblxuaW1wb3J0IGFzc2VydCBmcm9tIFwiYXNzZXJ0XCI7XG5pbXBvcnQgeyBzb3J0RGVlcCB9IGZyb20gXCIuLi91dGlsL2Fzc2VydEhlbHBlclwiO1xuXG5hc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICBzb3J0RGVlcChjb21iaW5hdGlvblN1bTIoWzEwLCAxLCAyLCA3LCA2LCAxLCA1XSwgOCkpLFxuICBzb3J0RGVlcChbXG4gICAgWzEsIDddLFxuICAgIFsxLCAyLCA1XSxcbiAgICBbMiwgNl0sXG4gICAgWzEsIDEsIDZdLFxuICBdKVxuKTtcbmFzc2VydC5kZWVwU3RyaWN0RXF1YWwoXG4gIHNvcnREZWVwKGNvbWJpbmF0aW9uU3VtMihbMiwgNSwgMiwgMSwgMl0sIDUpKSxcbiAgc29ydERlZXAoW1sxLCAyLCAyXSwgWzVdXSlcbik7XG5hc3NlcnQuZGVlcFN0cmljdEVxdWFsKHNvcnREZWVwKGNvbWJpbmF0aW9uU3VtMihbMSwgMV0sIDEpKSwgc29ydERlZXAoW1sxXV0pKTtcblxuYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChcbiAgc29ydERlZXAoY29tYmluYXRpb25TdW0zKFsxMCwgMSwgMiwgNywgNiwgMSwgNV0sIDgpKSxcbiAgc29ydERlZXAoW1xuICAgIFsxLCA3XSxcbiAgICBbMSwgMiwgNV0sXG4gICAgWzIsIDZdLFxuICAgIFsxLCAxLCA2XSxcbiAgXSlcbik7XG5hc3NlcnQuZGVlcFN0cmljdEVxdWFsKFxuICBzb3J0RGVlcChjb21iaW5hdGlvblN1bTMoWzIsIDUsIDIsIDEsIDJdLCA1KSksXG4gIHNvcnREZWVwKFtbMSwgMiwgMl0sIFs1XV0pXG4pO1xuYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChzb3J0RGVlcChjb21iaW5hdGlvblN1bTMoWzEsIDFdLCAxKSksIHNvcnREZWVwKFtbMV1dKSk7XG5cbmltcG9ydCBCZW5jaG1hcmsgZnJvbSBcImJlbmNobWFya1wiO1xuY29uc3Qgc3VpdGUgPSBuZXcgQmVuY2htYXJrLlN1aXRlKCk7XG5cbmNvbnN0IGNhbmRpZGF0ZXMgPSBbMSwxXTtcbmNvbnN0IHRhcmdldCA9IDEgLy8gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcbmNvbnNvbGUubG9nKHRhcmdldClcblxuc3VpdGVcbiAgLmFkZChcInNvcnQgYW5kIGRmc1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgY29tYmluYXRpb25TdW0yKGNhbmRpZGF0ZXMsIHRhcmdldCk7XG4gIH0pXG4gIC5hZGQoXCJkZnNcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbWJpbmF0aW9uU3VtMyhjYW5kaWRhdGVzLCB0YXJnZXQpO1xuICB9KVxuICAub24oXCJjeWNsZVwiLCBmdW5jdGlvbiAoZXZlbnQ6IEJlbmNobWFyay5FdmVudCkge1xuICAgIGNvbnNvbGUubG9nKFN0cmluZyhldmVudC50YXJnZXQpKTtcbiAgfSlcbiAgLm9uKFwiY29tcGxldGVcIiwgZnVuY3Rpb24gKHRoaXM6IEJlbmNobWFyay5TdWl0ZSkge1xuICAgIC8vIGNvbnNvbGUubG9nKCdGYXN0ZXN0IGlzICcgKyB0aGlzLmZpbHRlcignZmFzdGVzdCcpLm1hcCggJ25hbWUnKSk7XG4gIH0pXG4gIC8vIHJ1biBhc3luY1xuICAucnVuKHsgYXN5bmM6IGZhbHNlIH0pO1xuXG4vKipcbiAqIGNvbWJpbmF0aW9uU3VtMyDkuI3mlbTnkIbmlbDmja7nmoQg5b+r55qE5aSaXG4gKiAqL1xuIl19