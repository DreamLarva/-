"use strict";
/*
编写一个程序，通过已填充的空格来解决数独问题。

一个数独的解法需遵循如下规则：

数字1-9在每一行只能出现一次。
数字1-9在每一列只能出现一次。
数字1-9在每一个以粗实线分隔的3x3宫内只能出现一次。
空白格用'.'表示。



一个数独。



答案被标成红色。

Note:

给定的数独序列只包含数字1-9和字符'.'。
你可以假设给定的数独只有唯一解。
给定数独永远是9x9形式的。

来源：力扣（LeetCode）
链接：https://leetcode-cn.com/problems/sudoku-solver
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
* */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const lodash_1 = __importDefault(require("lodash"));
/**
 Do not return anything, modify board in-place instead.
 */
function solveSudoku(board) {
    const allPositions = getAllPositions(board);
    step(board, allPositions);
}
function step(board, allPositions, index = 0) {
    if (index === allPositions.length)
        return true;
    const [y, x] = allPositions[index];
    const availableNums = getAvailableNums(board, x, y);
    if (availableNums.length === 0)
        return false;
    for (const num of availableNums) {
        board[y][x] = num;
        if (step(board, allPositions, index + 1))
            return true;
    }
    board[y][x] = ".";
    return false;
}
function getAllPositions(board) {
    const result = [];
    for (let y = 0; y < board.length; y++) {
        for (let x = 0; x < board[y].length; x++) {
            if (board[y][x] === ".") {
                result.push([y, x]);
            }
        }
    }
    return result;
}
function isValid(board, x, y) {
    // 行
    const row = board[y];
    if (row.every((v) => v !== ".") && lodash_1.default.uniq(row).length !== 9)
        return false;
    // 列
    const column = board.map((v) => v[x]);
    if (column.every((v) => v !== ".") && lodash_1.default.uniq(column).length !== 9)
        return false;
    // 块
    const block = getBlock(board, x, y);
    if (block.every((v) => v !== ".") && lodash_1.default.uniq(block).length !== 9)
        return false;
    return true;
}
function getAvailableNums(board, x, y) {
    const total = ["1", "2", "3", "4", "5", "6", "7", "8", "9"];
    // 行
    const row = board[y];
    // 列
    const column = board.map((v) => v[x]);
    // 块
    const block = getBlock(board, x, y);
    return [row, column, block].reduce((pre, cur) => lodash_1.default.difference(pre, cur), total);
}
function getBlock(board, x, y) {
    const xStart = Math.floor(x / 3) * 3;
    const yStart = Math.floor(y / 3) * 3;
    const arr = [];
    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            arr.push(board[yStart + i][xStart + j]);
        }
    }
    return arr;
}
const assert_1 = __importDefault(require("assert"));
function isValidSudoku(board) {
    // 存储每列的结果
    const columns = Array(9)
        .fill(0)
        .map(() => []);
    // 存储每行的结果
    const rows = Array(9)
        .fill(0)
        .map(() => []);
    // 存储每块的结果
    const blocks = Array(9)
        .fill(0)
        .map(() => []);
    for (let i = 0; i < board.length; i++) {
        for (let j = 0; j < board[i].length; j++) {
            let num = board[i][j];
            if (num === ".")
                continue;
            const num_element = parseInt(num);
            const box_index = Math.floor(i / 3) * 3 + Math.floor(j / 3);
            // 老样子 哈希表 判断重复
            rows[i][num_element] = (rows[i][num_element] || 0) + 1;
            columns[j][num_element] = (columns[j][num_element] || 0) + 1;
            blocks[box_index][num_element] =
                (blocks[box_index][num_element] || 0) + 1;
            if (rows[i][num_element] > 1 ||
                columns[j][num_element] > 1 ||
                blocks[box_index][num_element] > 1)
                return false;
        }
    }
    return true;
}
{
    const sample = [
        ["5", "3", ".", ".", "7", ".", ".", ".", "."],
        ["6", ".", ".", "1", "9", "5", ".", ".", "."],
        [".", "9", "8", ".", ".", ".", ".", "6", "."],
        ["8", ".", ".", ".", "6", ".", ".", ".", "3"],
        ["4", ".", ".", "8", ".", "3", ".", ".", "1"],
        ["7", ".", ".", ".", "2", ".", ".", ".", "6"],
        [".", "6", ".", ".", ".", ".", "2", "8", "."],
        [".", ".", ".", "4", "1", "9", ".", ".", "5"],
        [".", ".", ".", ".", "8", ".", ".", "7", "9"],
    ];
    solveSudoku(sample);
    assert_1.default.strictEqual(isValidSudoku(sample), true);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcu6Kej5pWw54usLmpzIiwic291cmNlUm9vdCI6Ii4vIiwic291cmNlcyI6WyJsZWV0Y29kZS8zNy7op6PmlbDni6wudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUEyQkk7Ozs7O0FBRUosb0RBQXVCO0FBQ3ZCOztHQUVHO0FBQ0gsU0FBUyxXQUFXLENBQUMsS0FBaUI7SUFDcEMsTUFBTSxZQUFZLEdBQUcsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBRTVDLElBQUksQ0FBQyxLQUFLLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDNUIsQ0FBQztBQUVELFNBQVMsSUFBSSxDQUFDLEtBQWlCLEVBQUUsWUFBZ0MsRUFBRSxLQUFLLEdBQUcsQ0FBQztJQUMxRSxJQUFJLEtBQUssS0FBSyxZQUFZLENBQUMsTUFBTTtRQUFFLE9BQU8sSUFBSSxDQUFDO0lBQy9DLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ25DLE1BQU0sYUFBYSxHQUFHLGdCQUFnQixDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDcEQsSUFBSSxhQUFhLENBQUMsTUFBTSxLQUFLLENBQUM7UUFBRSxPQUFPLEtBQUssQ0FBQztJQUM3QyxLQUFLLE1BQU0sR0FBRyxJQUFJLGFBQWEsRUFBRTtRQUMvQixLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO1FBQ2xCLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRSxZQUFZLEVBQUUsS0FBSyxHQUFHLENBQUMsQ0FBQztZQUFFLE9BQU8sSUFBSSxDQUFDO0tBQ3ZEO0lBQ0QsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztJQUNsQixPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFFRCxTQUFTLGVBQWUsQ0FBQyxLQUFp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QUVsQyxPQUFPLEtBQUssQ0FBQztTQUNoQjtLQUNGO0lBQ0QsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDO0FBRUQ7SUFDRSxNQUFNLE1BQU0sR0FBRztRQUNiLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDN0MsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUM3QyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQzdDLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDN0MsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUM3QyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQzdDLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDN0MsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUM3QyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO0tBQzlDLENBQUM7SUFDRixXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDcEIsZ0JBQU0sQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO0NBQ2pEIiwic291cmNlc0NvbnRlbnQiOlsiLypcbue8luWGmeS4gOS4queoi+W6j++8jOmAmui/h+W3suWhq+WFheeahOepuuagvOadpeino+WGs+aVsOeLrOmXrumimOOAglxuXG7kuIDkuKrmlbDni6znmoTop6Pms5XpnIDpgbXlvqrlpoLkuIvop4TliJnvvJpcblxu5pWw5a2XMS055Zyo5q+P5LiA6KGM5Y+q6IO95Ye6546w5LiA5qyh44CCXG7mlbDlrZcxLTnlnKjmr4/kuIDliJflj6rog73lh7rnjrDkuIDmrKHjgIJcbuaVsOWtlzEtOeWcqOavj+S4gOS4quS7peeyl+Wunue6v+WIhumalOeahDN4M+Wuq+WGheWPquiDveWHuueOsOS4gOasoeOAglxu56m655m95qC855SoJy4n6KGo56S644CCXG5cblxuXG7kuIDkuKrmlbDni6zjgIJcblxuXG5cbuetlOahiOiiq+agh+aIkOe6ouiJsuOAglxuXG5Ob3RlOlxuXG7nu5nlrprnmoTmlbDni6zluo/liJflj6rljIXlkKvmlbDlrZcxLTnlkozlrZfnrKYnLifjgIJcbuS9oOWPr+S7peWBh+iuvue7meWumueahOaVsOeLrOWPquacieWUr+S4gOino+OAglxu57uZ5a6a5pWw54us5rC46L+c5pivOXg55b2i5byP55qE44CCXG5cbuadpea6kO+8muWKm+aJo++8iExlZXRDb2Rl77yJXG7pk77mjqXvvJpodHRwczovL2xlZXRjb2RlLWNuLmNvbS9wcm9ibGVtcy9zdWRva3Utc29sdmVyXG7okZfkvZzmnYPlvZLpoobmiaPnvZHnu5zmiYDmnInjgILllYbkuJrovazovb3or7fogZTns7vlrpjmlrnmjojmnYPvvIzpnZ7llYbkuJrovazovb3or7fms6jmmI7lh7rlpITjgIJcbiogKi9cblxuaW1wb3J0IF8gZnJvbSBcImxvZGFzaFwiO1xuLyoqXG4gRG8gbm90IHJldHVybiBhbnl0aGluZywgbW9kaWZ5IGJvYXJkIGluLXBsYWNlIGluc3RlYWQuXG4gKi9cbmZ1bmN0aW9uIHNvbHZlU3Vkb2t1KGJvYXJkOiBzdHJpbmdbXVtdKTogdm9pZCB7XG4gIGNvbnN0IGFsbFBvc2l0aW9ucyA9IGdldEFsbFBvc2l0aW9ucyhib2FyZCk7XG5cbiAgc3RlcChib2FyZCwgYWxsUG9zaXRpb25zKTtcbn1cblxuZnVuY3Rpb24gc3RlcChib2FyZDogc3RyaW5nW11bXSwgYWxsUG9zaXRpb25zOiBbbnVtYmVyLCBudW1iZXJdW10sIGluZGV4ID0gMCkge1xuICBpZiAoaW5kZXggPT09IGFsbFBvc2l0aW9ucy5sZW5ndGgpIHJldHVybiB0cnVlO1xuICBjb25zdCBbeSwgeF0gPSBhbGxQb3NpdGlvbnNbaW5kZXhdO1xuICBjb25zdCBhdmFpbGFibGVOdW1zID0gZ2V0QXZhaWxhYmxlTnVtcyhib2FyZCwgeCwgeSk7XG4gIGlmIChhdmFpbGFibGVOdW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuICBmb3IgKGNvbnN0IG51bSBvZiBhdmFpbGFibGVOdW1zKSB7XG4gICAgYm9hcmRbeV1beF0gPSBudW07XG4gICAgaWYgKHN0ZXAoYm9hcmQsIGFsbFBvc2l0aW9ucywgaW5kZXggKyAxKSkgcmV0dXJuIHRydWU7XG4gIH1cbiAgYm9hcmRbeV1beF0gPSBcIi5cIjtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBnZXRBbGxQb3NpdGlvbnMoYm9hcmQ6IHN0cmluZ1tdW10pIHtcbiAgY29uc3QgcmVzdWx0OiBbbnVtYmVyLCBudW1iZXJdW10gPSBbXTtcbiAgZm9yIChsZXQgeSA9IDA7IHkgPCBib2FyZC5sZW5ndGg7IHkrKykge1xuICAgIGZvciAobGV0IHggPSAwOyB4IDwgYm9hcmRbeV0ubGVuZ3RoOyB4KyspIHtcbiAgICAgIGlmIChib2FyZFt5XVt4XSA9PT0gXCIuXCIpIHtcbiAgICAgICAgcmVzdWx0LnB1c2goW3ksIHhdKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gaXNWYWxpZChib2FyZDogc3RyaW5nW11bXSwgeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgLy8g6KGMXG4gIGNvbnN0IHJvdyA9IGJvYXJkW3ldO1xuICBpZiAocm93LmV2ZXJ5KCh2KSA9PiB2ICE9PSBcIi5cIikgJiYgXy51bmlxKHJvdykubGVuZ3RoICE9PSA5KSByZXR1cm4gZmFsc2U7XG4gIC8vIOWIl1xuICBjb25zdCBjb2x1bW4gPSBib2FyZC5tYXAoKHYpID0+IHZbeF0pO1xuICBpZiAoY29sdW1uLmV2ZXJ5KCh2KSA9PiB2ICE9PSBcIi5cIikgJiYgXy51bmlxKGNvbHVtbikubGVuZ3RoICE9PSA5KVxuICAgIHJldHVybiBmYWxzZTtcbiAgLy8g5Z2XXG4gIGNvbnN0IGJsb2NrID0gZ2V0QmxvY2soYm9hcmQsIHgsIHkpO1xuICBpZiAoYmxvY2suZXZlcnkoKHYpID0+IHYgIT09IFwiLlwiKSAmJiBfLnVuaXEoYmxvY2spLmxlbmd0aCAhPT0gOSkgcmV0dXJuIGZhbHNlO1xuXG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBnZXRBdmFpbGFibGVOdW1zKGJvYXJkOiBzdHJpbmdbXVtdLCB4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICBjb25zdCB0b3RhbCA9IFtcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCIsIFwiNlwiLCBcIjdcIiwgXCI4XCIsIFwiOVwiXTtcbiAgLy8g6KGMXG4gIGNvbnN0IHJvdyA9IGJvYXJkW3ldO1xuICAvLyDliJdcbiAgY29uc3QgY29sdW1uID0gYm9hcmQubWFwKCh2KSA9PiB2W3hdKTtcbiAgLy8g5Z2XXG4gIGNvbnN0IGJsb2NrID0gZ2V0QmxvY2soYm9hcmQsIHgsIHkpO1xuXG4gIHJldHVybiBbcm93LCBjb2x1bW4sIGJsb2NrXS5yZWR1Y2UoXG4gICAgKHByZSwgY3VyKSA9PiBfLmRpZmZlcmVuY2UocHJlLCBjdXIpLFxuICAgIHRvdGFsXG4gICk7XG59XG5cbmZ1bmN0aW9uIGdldEJsb2NrKGJvYXJkOiBzdHJpbmdbXVtdLCB4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICBjb25zdCB4U3RhcnQgPSBNYXRoLmZsb29yKHggLyAzKSAqIDM7XG4gIGNvbnN0IHlTdGFydCA9IE1hdGguZmxvb3IoeSAvIDMpICogMztcblxuICBjb25zdCBhcnI6IHN0cmluZ1tdID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykge1xuICAgICAgYXJyLnB1c2goYm9hcmRbeVN0YXJ0ICsgaV1beFN0YXJ0ICsgal0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhcnI7XG59XG5cbmltcG9ydCBhc3NlcnQgZnJvbSBcImFzc2VydFwiO1xuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nW11bXX0gYm9hcmRcbiAqIEByZXR1cm4ge2Jvb2xlYW59XG4gKi9cbnR5cGUgU3Vkb2t1RWxlbWVudCA9IHN0cmluZzsgLy8gXCIuXCIgfCBcIjFcIiB8IFwiMlwiIHwgXCIzXCIgfCBcIjRcIiB8IFwiNVwiIHwgXCI2XCIgfCBcIjdcIiB8IFwiOFwiIHwgXCI5XCI7XG5mdW5jdGlvbiBpc1ZhbGlkU3Vkb2t1KGJvYXJkOiBTdWRva3VFbGVtZW50W11bXSkge1xuICAvLyDlrZjlgqjmr4/liJfnmoTnu5PmnpxcbiAgY29uc3QgY29sdW1uczogbnVtYmVyW11bXSA9IEFycmF5KDkpXG4gICAgLmZpbGwoMClcbiAgICAubWFwKCgpID0+IFtdKTtcbiAgLy8g5a2Y5YKo5q+P6KGM55qE57uT5p6cXG4gIGNvbnN0IHJvd3M6IG51bWJlcltdW10gPSBBcnJheSg5KVxuICAgIC5maWxsKDApXG4gICAgLm1hcCgoKSA9PiBbXSk7XG4gIC8vIOWtmOWCqOavj+Wdl+eahOe7k+aenFxuICBjb25zdCBibG9ja3M6IG51bWJlcltdW10gPSBBcnJheSg5KVxuICAgIC5maWxsKDApXG4gICAgLm1hcCgoKSA9PiBbXSk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZC5sZW5ndGg7IGkrKykge1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgYm9hcmRbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgIGxldCBudW0gPSBib2FyZFtpXVtqXTtcbiAgICAgIGlmIChudW0gPT09IFwiLlwiKSBjb250aW51ZTtcbiAgICAgIGNvbnN0IG51bV9lbGVtZW50ID0gcGFyc2VJbnQobnVtKTtcbiAgICAgIGNvbnN0IGJveF9pbmRleCA9IE1hdGguZmxvb3IoaSAvIDMpICogMyArIE1hdGguZmxvb3IoaiAvIDMpO1xuICAgICAgLy8g6ICB5qC35a2QIOWTiOW4jOihqCDliKTmlq3ph43lpI1cbiAgICAgIHJvd3NbaV1bbnVtX2VsZW1lbnRdID0gKHJvd3NbaV1bbnVtX2VsZW1lbnRdIHx8IDApICsgMTtcbiAgICAgIGNvbHVtbnNbal1bbnVtX2VsZW1lbnRdID0gKGNvbHVtbnNbal1bbnVtX2VsZW1lbnRdIHx8IDApICsgMTtcbiAgICAgIGJsb2Nrc1tib3hfaW5kZXhdW251bV9lbGVtZW50XSA9XG4gICAgICAgIChibG9ja3NbYm94X2luZGV4XVtudW1fZWxlbWVudF0gfHwgMCkgKyAxO1xuXG4gICAgICBpZiAoXG4gICAgICAgIHJvd3NbaV1bbnVtX2VsZW1lbnRdID4gMSB8fFxuICAgICAgICBjb2x1bW5zW2pdW251bV9lbGVtZW50XSA+IDEgfHxcbiAgICAgICAgYmxvY2tzW2JveF9pbmRleF1bbnVtX2VsZW1lbnRdID4gMVxuICAgICAgKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG57XG4gIGNvbnN0IHNhbXBsZSA9IFtcbiAgICBbXCI1XCIsIFwiM1wiLCBcIi5cIiwgXCIuXCIsIFwiN1wiLCBcIi5cIiwgXCIuXCIsIFwiLlwiLCBcIi5cIl0sXG4gICAgW1wiNlwiLCBcIi5cIiwgXCIuXCIsIFwiMVwiLCBcIjlcIiwgXCI1XCIsIFwiLlwiLCBcIi5cIiwgXCIuXCJdLFxuICAgIFtcIi5cIiwgXCI5XCIsIFwiOFwiLCBcIi5cIiwgXCIuXCIsIFwiLlwiLCBcIi5cIiwgXCI2XCIsIFwiLlwiXSxcbiAgICBbXCI4XCIsIFwiLlwiLCBcIi5cIiwgXCIuXCIsIFwiNlwiLCBcIi5cIiwgXCIuXCIsIFwiLlwiLCBcIjNcIl0sXG4gICAgW1wiNFwiLCBcIi5cIiwgXCIuXCIsIFwiOFwiLCBcIi5cIiwgXCIzXCIsIFwiLlwiLCBcIi5cIiwgXCIxXCJdLFxuICAgIFtcIjdcIiwgXCIuXCIsIFwiLlwiLCBcIi5cIiwgXCIyXCIsIFwiLlwiLCBcIi5cIiwgXCIuXCIsIFwiNlwiXSxcbiAgICBbXCIuXCIsIFwiNlwiLCBcIi5cIiwgXCIuXCIsIFwiLlwiLCBcIi5cIiwgXCIyXCIsIFwiOFwiLCBcIi5cIl0sXG4gICAgW1wiLlwiLCBcIi5cIiwgXCIuXCIsIFwiNFwiLCBcIjFcIiwgXCI5XCIsIFwiLlwiLCBcIi5cIiwgXCI1XCJdLFxuICAgIFtcIi5cIiwgXCIuXCIsIFwiLlwiLCBcIi5cIiwgXCI4XCIsIFwiLlwiLCBcIi5cIiwgXCI3XCIsIFwiOVwiXSxcbiAgXTtcbiAgc29sdmVTdWRva3Uoc2FtcGxlKTtcbiAgYXNzZXJ0LnN0cmljdEVxdWFsKGlzVmFsaWRTdWRva3Uoc2FtcGxlKSwgdHJ1ZSk7XG59XG4iXX0=