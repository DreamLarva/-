"use strict";
/*
您将获得一个双向链表，除了下一个和前一个指针之外，它还有一个子指针，可能指向单独的双向链表。
这些子列表可能有一个或多个自己的子项，依此类推，生成多级数据结构，如下面的示例所示。

扁平化列表，使所有结点出现在单级双链表中。您将获得列表第一级的头部。

示例:

输入:
 1,,,2,,,3,,,4,,,5,,,6,,NULL
         |
         7,,,8,,,9,,,10,,NULL
             |
             11,,12,,NULL

输出:
1,2,3,7,8,11,12,9,10,4,5,6,NULL

来源：力扣（LeetCode）
链接：https://leetcode,cn.com/problems/flatten,a,multilevel,doubly,linked,list
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
* */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
class Node {
    constructor(val) {
        this.val = val;
        this.prev = null;
        this.child = null;
        this.next = null;
        this.val = val;
    }
}
/**
 * @param {Node} head
 * @return {Node}
 */
var flatten = function (head) {
    let left_junction = head;
    while (left_junction != null) {
        if (left_junction.child) {
            const right_junction = left_junction.next;
            // 连接 左侧
            left_junction.next = left_junction.child;
            left_junction.child.prev = left_junction;
            // 找到 尾节点
            let child_tail = left_junction.child;
            while (child_tail.next != null) {
                child_tail = child_tail.next;
            }
            // 连接右侧
            if (right_junction)
                right_junction.prev = child_tail;
            child_tail.next = right_junction;
            left_junction.child = null;
        }
        // 继续遍历
        left_junction = left_junction.next;
    }
    return head;
};
/**
 * 虽然我的方法是递归但是 我的方法 每个节点的只访问一次 但是慢?
 * */
var flatten1 = function (head) {
    if (head == null)
        return null;
    let left_junction;
    step(head);
    return head;
    function step(head) {
        let next = null;
        if (left_junction) {
            next = left_junction.next;
        }
        if (!left_junction) {
            left_junction = head;
        }
        else {
            left_junction.next = head;
            head.prev = left_junction;
        }
        let currentNode = head;
        let tail = currentNode;
        while (currentNode) {
            left_junction = currentNode;
            if (currentNode.child) {
                step(currentNode.child);
                currentNode.child = null;
            }
            tail = currentNode;
            currentNode = currentNode.next;
            // left_junction = currentNode;
        }
        if (next != null) {
            next.prev = tail;
        }
        tail.next = next;
    }
};
const assert_1 = __importDefault(require("assert"));
const DoubleLinkedList_1 = require("../util/DoubleLinkedList");
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1]);
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1, 2, 3, 4, 5, 6]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([7, 8, 9, 10]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([11, 12]);
    line_1.next.next.child = line_2;
    line_2.next.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [
        1,
        2,
        3,
        7,
        8,
        11,
        12,
        9,
        10,
        4,
        5,
        6,
    ]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([7, 8, 9, 10]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([11, 12]);
    line_1.child = line_2;
    line_2.next.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1, 7, 8, 11, 12, 9, 10]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([2]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([3]);
    line_1.child = line_2;
    line_2.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1, 2, 3]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1, 2, 5, 7]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([3, 4]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([6]);
    line_1.next.child = line_2;
    line_1.next.next.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1, 2, 3, 4, 5, 6, 7]);
}
/**
 * 事实证明 在链表足够长额情况下 我的方法更快啊
 * */
const Benchmark = require("benchmark");
{
    const randomArray = (num) => new Array(num).fill(1).map(() => Math.random());
    const suite = new Benchmark.Suite();
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList(randomArray(10000));
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList(randomArray(10000));
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList(randomArray(10000));
    line_1.next.child = line_2;
    line_1.next.next.child = line_3;
    suite
        .add("top", function () {
        flatten(line_1);
    })
        .add("mine", function () {
        flatten1(line_1);
    })
        // add listeners
        .on("cycle", function (event) {
        console.log(String(event.target));
    })
        .on("complete", function () {
        console.log("Fastest is " + this.filter("fastest").map("name"));
    })
        // run async
        .run({ async: false });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDMwLuaJgeW5s+WMluWkmue6p+WPjOWQkemTvuihqC5qcyIsInNvdXJjZVJvb3QiOiIuLyIsInNvdXJjZXMiOlsibGVldGNvZGUvNDMwLuaJgeW5s+WMluWkmue6p+WPjOWQkemTvuihqC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQXFCSTs7Ozs7QUFFSixNQUFNLElBQUk7SUFLTixZQUFtQixHQUFNO1FBQU4sUUFBRyxHQUFILEdBQUcsQ0FBRztRQUp6QixTQUFJLEdBQWdCLElBQUksQ0FBQztRQUN6QixVQUFLLEdBQWdCLElBQUksQ0FBQztRQUMxQixTQUFJLEdBQWdCLElBQUksQ0FBQztRQUdyQixJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUNuQixDQUFDO0NBQ0o7QUFFRDs7O0dBR0c7QUFDSCxJQUFJLE9BQU8sR0FBRyxVQUFVLElBQWlCO0lBQ3JDLElBQUksYUFBYSxHQUFHLElBQUksQ0FBQztJQUN6QixPQUFPLGFBQWEsSUFBSSxJQUFJLEVBQUU7UUFDMUIsSUFBSSxhQUFhLENBQUMsS0FBSyxFQUFFO1lBQ3JCLE1BQU0sY0FBYyxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUM7WUFDMUMsUUFBUTtZQUNSLGFBQWEsQ0FBQyxJQUFJLEdBQUcsYUFBYSxDQUFDLEtBQUssQ0FBQztZQUN6QyxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxhQUFhLENBQUM7WUFFekMsU0FBUztZQUNULElBQUksVUFBVSxHQUFHLGFBQWEsQ0FBQyxLQUFLLENBQUM7WUFDckMsT0FBTyxVQUFVLENBQUMsSUFBSSxJQUFJLElBQUksRUFBRTtnQkFDNUIsVUFBVSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUM7YUFDaEM7WUFFRCxPQUFPO1lBQ1AsSUFBSSxjQUFjO2dCQUFFLGNBQWMsQ0FBQyxJQUFJLEdBQUcsVUFBVSxDQUFDO1lBQ3JELFVBQVUsQ0FBQyxJQUFJLEdBQUcsY0FBYyxDQUFDO1lBQ2pDLGFB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RUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzlDLE1BQU0sTUFBTSxHQUFHLHlDQUFzQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUUzQyxNQUFNLENBQUMsSUFBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7SUFDNUIsTUFBTSxDQUFDLElBQUssQ0FBQyxJQUFLLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztJQUVsQyxnQkFBTSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFFLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQzlFO0FBRUQ7O0tBRUs7QUFDTCxNQUFNLFNBQVMsR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDdkM7SUFDSSxNQUFNLFdBQVcsR0FBRyxDQUFDLEdBQVcsRUFBRSxFQUFFLENBQ2hDLElBQUksS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7SUFDcEQsTUFBTSxLQUFLLEdBQUcsSUFBSSxTQUFTLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDcEMsTUFBTSxNQUFNLEdBQUcseUNBQXNCLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDMUQsTUFBTSxNQUFNLEdBQUcseUNBQXNCLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDMUQsTUFBTSxNQUFNLEdBQUcseUNBQXNCLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFFMUQsTUFBTSxDQUFDLElBQUssQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDO0lBQzVCLE1BQU0sQ0FBQyxJQUFLLENBQUMsSUFBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7SUFFbEMsS0FBSztTQUNBLEdBQUcsQ0FBQyxLQUFLLEVBQUU7UUFDUixPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDcEIsQ0FBQyxDQUFDO1NBQ0QsR0FBRyxDQUFDLE1BQU0sRUFBRTtRQUNULFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNyQixDQUFDLENBQUM7UUFFRixnQkFBZ0I7U0FDZixFQUFFLENBQUMsT0FBTyxFQUFFLFVBQVUsS0FBVTtRQUM3QixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUN0QyxDQUFDLENBQUM7U0FDRCxFQUFFLENBQUMsVUFBVSxFQUFFO1FBQ1osT0FBTyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNwRSxDQUFDLENBQUM7UUFDRixZQUFZO1NBQ1gsR0FBRyxDQUFDLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7Q0FFNUIiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxu5oKo5bCG6I635b6X5LiA5Liq5Y+M5ZCR6ZO+6KGo77yM6Zmk5LqG5LiL5LiA5Liq5ZKM5YmN5LiA5Liq5oyH6ZKI5LmL5aSW77yM5a6D6L+Y5pyJ5LiA5Liq5a2Q5oyH6ZKI77yM5Y+v6IO95oyH5ZCR5Y2V54us55qE5Y+M5ZCR6ZO+6KGo44CCXG7ov5nkupvlrZDliJfooajlj6/og73mnInkuIDkuKrmiJblpJrkuKroh6rlt7HnmoTlrZDpobnvvIzkvp3mraTnsbvmjqjvvIznlJ/miJDlpJrnuqfmlbDmja7nu5PmnoTvvIzlpoLkuIvpnaLnmoTnpLrkvovmiYDnpLrjgIJcblxu5omB5bmz5YyW5YiX6KGo77yM5L2/5omA5pyJ57uT54K55Ye6546w5Zyo5Y2V57qn5Y+M6ZO+6KGo5Lit44CC5oKo5bCG6I635b6X5YiX6KGo56ys5LiA57qn55qE5aS06YOo44CCXG5cbuekuuS+izpcblxu6L6T5YWlOlxuIDEsLCwyLCwsMywsLDQsLCw1LCwsNiwsTlVMTFxuICAgICAgICAgfFxuICAgICAgICAgNywsLDgsLCw5LCwsMTAsLE5VTExcbiAgICAgICAgICAgICB8XG4gICAgICAgICAgICAgMTEsLDEyLCxOVUxMXG5cbui+k+WHujpcbjEsMiwzLDcsOCwxMSwxMiw5LDEwLDQsNSw2LE5VTExcblxu5p2l5rqQ77ya5Yqb5omj77yITGVldENvZGXvvIlcbumTvuaOpe+8mmh0dHBzOi8vbGVldGNvZGUsY24uY29tL3Byb2JsZW1zL2ZsYXR0ZW4sYSxtdWx0aWxldmVsLGRvdWJseSxsaW5rZWQsbGlzdFxu6JGX5L2c5p2D5b2S6aKG5omj572R57uc5omA5pyJ44CC5ZWG5Lia6L2s6L296K+36IGU57O75a6Y5pa55o6I5p2D77yM6Z2e5ZWG5Lia6L2s6L296K+35rOo5piO5Ye65aSE44CCXG4qICovXG5cbmNsYXNzIE5vZGU8VCA9IGFueT4ge1xuICAgIHByZXY6IG51bGwgfCBOb2RlID0gbnVsbDtcbiAgICBjaGlsZDogbnVsbCB8IE5vZGUgPSBudWxsO1xuICAgIG5leHQ6IG51bGwgfCBOb2RlID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyB2YWw6IFQpIHtcbiAgICAgICAgdGhpcy52YWwgPSB2YWw7XG4gICAgfVxufVxuXG4vKipcbiAqIEBwYXJhbSB7Tm9kZX0gaGVhZFxuICogQHJldHVybiB7Tm9kZX1cbiAqL1xudmFyIGZsYXR0ZW4gPSBmdW5jdGlvbiAoaGVhZDogTm9kZSB8IG51bGwpIHtcbiAgICBsZXQgbGVmdF9qdW5jdGlvbiA9IGhlYWQ7XG4gICAgd2hpbGUgKGxlZnRfanVuY3Rpb24gIT0gbnVsbCkge1xuICAgICAgICBpZiAobGVmdF9qdW5jdGlvbi5jaGlsZCkge1xuICAgICAgICAgICAgY29uc3QgcmlnaHRfanVuY3Rpb24gPSBsZWZ0X2p1bmN0aW9uLm5leHQ7XG4gICAgICAgICAgICAvLyDov57mjqUg5bem5L6nXG4gICAgICAgICAgICBsZWZ0X2p1bmN0aW9uLm5leHQgPSBsZWZ0X2p1bmN0aW9uLmNoaWxkO1xuICAgICAgICAgICAgbGVmdF9qdW5jdGlvbi5jaGlsZC5wcmV2ID0gbGVmdF9qdW5jdGlvbjtcblxuICAgICAgICAgICAgLy8g5om+5YiwIOWwvuiKgueCuVxuICAgICAgICAgICAgbGV0IGNoaWxkX3RhaWwgPSBsZWZ0X2p1bmN0aW9uLmNoaWxkO1xuICAgICAgICAgICAgd2hpbGUgKGNoaWxkX3RhaWwubmV4dCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY2hpbGRfdGFpbCA9IGNoaWxkX3RhaWwubmV4dDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8g6L+e5o6l5Y+z5L6nXG4gICAgICAgICAgICBpZiAocmlnaHRfanVuY3Rpb24pIHJpZ2h0X2p1bmN0aW9uLnByZXYgPSBjaGlsZF90YWlsO1xuICAgICAgICAgICAgY2hpbGRfdGFpbC5uZXh0ID0gcmlnaHRfanVuY3Rpb247XG4gICAgICAgICAgICBsZWZ0X2p1bmN0aW9uLmNoaWxkID0gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIOe7p+e7remBjeWOhlxuICAgICAgICBsZWZ0X2p1bmN0aW9uID0gbGVmdF9qdW5jdGlvbi5uZXh0O1xuICAgIH1cbiAgICByZXR1cm4gaGVhZDtcbn07XG4vKipcbiAqIOiZveeEtuaIkeeahOaWueazleaYr+mAkuW9kuS9huaYryDmiJHnmoTmlrnms5Ug5q+P5Liq6IqC54K555qE5Y+q6K6/6Zeu5LiA5qyhIOS9huaYr+aFoj9cbiAqICovXG52YXIgZmxhdHRlbjEgPSBmdW5jdGlvbiAoaGVhZDogTm9kZSB8IG51bGwpIHtcbiAgICBpZiAoaGVhZCA9PSBudWxsKSByZXR1cm4gbnVsbDtcbiAgICBsZXQgbGVmdF9qdW5jdGlvbjogTm9kZTtcbiAgICBzdGVwKGhlYWQpO1xuICAgIHJldHVybiBoZWFkO1xuXG4gICAgZnVuY3Rpb24gc3RlcChoZWFkOiBOb2RlKSB7XG4gICAgICAgIGxldCBuZXh0ID0gbnVsbDtcbiAgICAgICAgaWYgKGxlZnRfanVuY3Rpb24pIHtcbiAgICAgICAgICAgIG5leHQgPSBsZWZ0X2p1bmN0aW9uLm5leHQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWxlZnRfanVuY3Rpb24pIHtcbiAgICAgICAgICAgIGxlZnRfanVuY3Rpb24gPSBoZWFkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGVmdF9qdW5jdGlvbi5uZXh0ID0gaGVhZDtcbiAgICAgICAgICAgIGhlYWQucHJldiA9IGxlZnRfanVuY3Rpb247XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSBoZWFkO1xuICAgICAgICBsZXQgdGFpbCA9IGN1cnJlbnROb2RlO1xuICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUpIHtcbiAgICAgICAgICAgIGxlZnRfanVuY3Rpb24gPSBjdXJyZW50Tm9kZTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50Tm9kZS5jaGlsZCkge1xuICAgICAgICAgICAgICAgIHN0ZXAoY3VycmVudE5vZGUuY2hpbGQpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlLmNoaWxkID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRhaWwgPSBjdXJyZW50Tm9kZTtcbiAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dCE7XG4gICAgICAgICAgICAvLyBsZWZ0X2p1bmN0aW9uID0gY3VycmVudE5vZGU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmV4dCAhPSBudWxsKSB7XG4gICAgICAgICAgICBuZXh0LnByZXYgPSB0YWlsO1xuICAgICAgICB9XG4gICAgICAgIHRhaWwubmV4dCA9IG5leHQ7XG4gICAgfVxufTtcblxuaW1wb3J0IGFzc2VydCBmcm9tIFwiYXNzZXJ0XCI7XG5pbXBvcnQge2NyZWF0ZURvdWJsZUxpbmtlZExpc3R9IGZyb20gXCIuLi91dGlsL0RvdWJsZUxpbmtlZExpc3RcIjtcblxue1xuICAgIGNvbnN0IGxpbmVfMSA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzFdKTtcblxuICAgIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmxhdHRlbihsaW5lXzEpIS50b1N0cmluZygpLCBbMV0pO1xufVxue1xuICAgIGNvbnN0IGxpbmVfMSA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzEsIDIsIDMsIDQsIDUsIDZdKTtcbiAgICBjb25zdCBsaW5lXzIgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFs3LCA4LCA5LCAxMF0pO1xuICAgIGNvbnN0IGxpbmVfMyA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzExLCAxMl0pO1xuXG4gICAgbGluZV8xLm5leHQhLm5leHQhLmNoaWxkID0gbGluZV8yO1xuICAgIGxpbmVfMi5uZXh0IS5jaGlsZCA9IGxpbmVfMztcblxuICAgIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmxhdHRlbihsaW5lXzEpIS50b1N0cmluZygpLCBbXG4gICAgICAgIDEsXG4gICAgICAgIDIsXG4gICAgICAgIDMsXG4gICAgICAgIDcsXG4gICAgICAgIDgsXG4gICAgICAgIDExLFxuICAgICAgICAxMixcbiAgICAgICAgOSxcbiAgICAgICAgMTAsXG4gICAgICAgIDQsXG4gICAgICAgIDUsXG4gICAgICAgIDYsXG4gICAgXSk7XG59XG57XG4gICAgY29uc3QgbGluZV8xID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChbMV0pO1xuICAgIGNvbnN0IGxpbmVfMiA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzcsIDgsIDksIDEwXSk7XG4gICAgY29uc3QgbGluZV8zID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChbMTEsIDEyXSk7XG5cbiAgICBsaW5lXzEuY2hpbGQgPSBsaW5lXzI7XG4gICAgbGluZV8yLm5leHQhLmNoaWxkID0gbGluZV8zO1xuXG4gICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmbGF0dGVuKGxpbmVfMSkhLnRvU3RyaW5nKCksIFsxLCA3LCA4LCAxMSwgMTIsIDksIDEwXSk7XG59XG57XG4gICAgY29uc3QgbGluZV8xID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChbMV0pO1xuICAgIGNvbnN0IGxpbmVfMiA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzJdKTtcbiAgICBjb25zdCBsaW5lXzMgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFszXSk7XG5cbiAgICBsaW5lXzEuY2hpbGQgPSBsaW5lXzI7XG4gICAgbGluZV8yLmNoaWxkID0gbGluZV8zO1xuXG4gICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmbGF0dGVuKGxpbmVfMSkhLnRvU3RyaW5nKCksIFsxLCAyLCAzXSk7XG59XG57XG4gICAgY29uc3QgbGluZV8xID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChbMSwgMiwgNSwgN10pO1xuICAgIGNvbnN0IGxpbmVfMiA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzMsIDRdKTtcbiAgICBjb25zdCBsaW5lXzMgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFs2XSk7XG5cbiAgICBsaW5lXzEubmV4dCEuY2hpbGQgPSBsaW5lXzI7XG4gICAgbGluZV8xLm5leHQhLm5leHQhLmNoaWxkID0gbGluZV8zO1xuXG4gICAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmbGF0dGVuKGxpbmVfMSkhLnRvU3RyaW5nKCksIFsxLCAyLCAzLCA0LCA1LCA2LCA3XSk7XG59XG5cbi8qKlxuICog5LqL5a6e6K+B5piOIOWcqOmTvuihqOi2s+Wkn+mVv+mineaDheWGteS4iyDmiJHnmoTmlrnms5Xmm7Tlv6vllYpcbiAqICovXG5jb25zdCBCZW5jaG1hcmsgPSByZXF1aXJlKFwiYmVuY2htYXJrXCIpO1xue1xuICAgIGNvbnN0IHJhbmRvbUFycmF5ID0gKG51bTogbnVtYmVyKSA9PlxuICAgICAgICBuZXcgQXJyYXkobnVtKS5maWxsKDEpLm1hcCgoKSA9PiBNYXRoLnJhbmRvbSgpKTtcbiAgICBjb25zdCBzdWl0ZSA9IG5ldyBCZW5jaG1hcmsuU3VpdGUoKTtcbiAgICBjb25zdCBsaW5lXzEgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KHJhbmRvbUFycmF5KDEwMDAwKSk7XG4gICAgY29uc3QgbGluZV8yID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChyYW5kb21BcnJheSgxMDAwMCkpO1xuICAgIGNvbnN0IGxpbmVfMyA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QocmFuZG9tQXJyYXkoMTAwMDApKTtcblxuICAgIGxpbmVfMS5uZXh0IS5jaGlsZCA9IGxpbmVfMjtcbiAgICBsaW5lXzEubmV4dCEubmV4dCEuY2hpbGQgPSBsaW5lXzM7XG5cbiAgICBzdWl0ZVxuICAgICAgICAuYWRkKFwidG9wXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGZsYXR0ZW4obGluZV8xKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmFkZChcIm1pbmVcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZmxhdHRlbjEobGluZV8xKTtcbiAgICAgICAgfSlcblxuICAgICAgICAvLyBhZGQgbGlzdGVuZXJzXG4gICAgICAgIC5vbihcImN5Y2xlXCIsIGZ1bmN0aW9uIChldmVudDogYW55KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhTdHJpbmcoZXZlbnQudGFyZ2V0KSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5vbihcImNvbXBsZXRlXCIsIGZ1bmN0aW9uICh0aGlzOiBhbnkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmFzdGVzdCBpcyBcIiArIHRoaXMuZmlsdGVyKFwiZmFzdGVzdFwiKS5tYXAoXCJuYW1lXCIpKTtcbiAgICAgICAgfSlcbiAgICAgICAgLy8gcnVuIGFzeW5jXG4gICAgICAgIC5ydW4oe2FzeW5jOiBmYWxzZX0pO1xuXG59XG4iXX0=