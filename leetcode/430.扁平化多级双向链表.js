"use strict";
/*
您将获得一个双向链表，除了下一个和前一个指针之外，它还有一个子指针，可能指向单独的双向链表。
这些子列表可能有一个或多个自己的子项，依此类推，生成多级数据结构，如下面的示例所示。

扁平化列表，使所有结点出现在单级双链表中。您将获得列表第一级的头部。

示例:

输入:
 1,,,2,,,3,,,4,,,5,,,6,,NULL
         |
         7,,,8,,,9,,,10,,NULL
             |
             11,,12,,NULL

输出:
1,2,3,7,8,11,12,9,10,4,5,6,NULL

来源：力扣（LeetCode）
链接：https://leetcode,cn.com/problems/flatten,a,multilevel,doubly,linked,list
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
* */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
class Node {
    constructor(val) {
        this.val = val;
        this.prev = null;
        this.child = null;
        this.next = null;
        this.val = val;
    }
}
/**
 * @param {Node} head
 * @return {Node}
 */
var flatten = function (head) {
    let left_junction = head;
    while (left_junction != null) {
        if (left_junction.child) {
            const right_junction = left_junction.next;
            // 连接 左侧
            left_junction.next = left_junction.child;
            left_junction.child.prev = left_junction;
            // 找到 尾节点
            let child_tail = left_junction.child;
            while (child_tail.next != null) {
                child_tail = child_tail.next;
            }
            // 连接右侧
            if (right_junction)
                right_junction.prev = child_tail;
            child_tail.next = right_junction;
            left_junction.child = null;
        }
        // 继续遍历
        left_junction = left_junction.next;
    }
    return head;
};
/**
 * 虽然我的方法是递归但是 我的方法 每个节点的只访问一次 但是慢?
 * */
var flatten1 = function (head) {
    if (head == null)
        return null;
    let left_junction;
    step(head);
    return head;
    function step(head) {
        let next = null;
        if (left_junction) {
            next = left_junction.next;
        }
        if (!left_junction) {
            left_junction = head;
        }
        else {
            left_junction.next = head;
            head.prev = left_junction;
        }
        let currentNode = head;
        let tail = currentNode;
        while (currentNode) {
            left_junction = currentNode;
            if (currentNode.child) {
                step(currentNode.child);
                currentNode.child = null;
            }
            tail = currentNode;
            currentNode = currentNode.next;
            // left_junction = currentNode;
        }
        if (next != null) {
            next.prev = tail;
        }
        tail.next = next;
    }
};
const assert_1 = __importDefault(require("assert"));
const DoubleLinkedList_1 = require("../util/DoubleLinkedList");
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1]);
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1, 2, 3, 4, 5, 6]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([7, 8, 9, 10]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([11, 12]);
    line_1.next.next.child = line_2;
    line_2.next.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [
        1,
        2,
        3,
        7,
        8,
        11,
        12,
        9,
        10,
        4,
        5,
        6,
    ]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([7, 8, 9, 10]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([11, 12]);
    line_1.child = line_2;
    line_2.next.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1, 7, 8, 11, 12, 9, 10]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([2]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([3]);
    line_1.child = line_2;
    line_2.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1, 2, 3]);
}
{
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList([1, 2, 5, 7]);
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList([3, 4]);
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList([6]);
    line_1.next.child = line_2;
    line_1.next.next.child = line_3;
    assert_1.default.deepStrictEqual(flatten(line_1).toString(), [1, 2, 3, 4, 5, 6, 7]);
}
/**
 * 事实证明 在链表足够长额情况下 我的方法更快啊
 * */
const Benchmark = require("benchmark");
{
    const randomArray = (num) => new Array(num).fill(1).map(() => Math.random());
    const suite = new Benchmark.Suite();
    const line_1 = DoubleLinkedList_1.createDoubleLinkedList(randomArray(10000));
    const line_2 = DoubleLinkedList_1.createDoubleLinkedList(randomArray(10000));
    const line_3 = DoubleLinkedList_1.createDoubleLinkedList(randomArray(10000));
    line_1.next.child = line_2;
    line_1.next.next.child = line_3;
    suite
        .add("top", function () {
        flatten(line_1);
    })
        .add("mine", function () {
        flatten1(line_1);
    })
        // add listeners
        .on("cycle", function (event) {
        console.log(String(event.target));
    })
        .on("complete", function () {
        console.log("Fastest is " + this.filter("fastest").map("name"));
    })
        // run async
        .run({ async: false });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDMwLuaJgeW5s+WMluWkmue6p+WPjOWQkemTvuihqC5qcyIsInNvdXJjZVJvb3QiOiIuLyIsInNvdXJjZXMiOlsibGVldGNvZGUvNDMwLuaJgeW5s+WMluWkmue6p+WPjOWQkemTvuihqC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQXFCSTs7Ozs7QUFFSixNQUFNLElBQUk7SUFLUixZQUFtQixHQUFNO1FBQU4sUUFBRyxHQUFILEdBQUcsQ0FBRztRQUp6QixTQUFJLEdBQWdCLElBQUksQ0FBQztRQUN6QixVQUFLLEdBQWdCLElBQUksQ0FBQztRQUMxQixTQUFJLEdBQWdCLElBQUksQ0FBQztRQUd2QixJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUNqQixDQUFDO0NBQ0Y7QUFFRDs7O0dBR0c7QUFDSCxJQUFJLE9BQU8sR0FBRyxVQUFVLElBQWlCO0lBQ3ZDLElBQUksYUFBYSxHQUFHLElBQUksQ0FBQztJQUN6QixPQUFPLGFBQWEsSUFBSSxJQUFJLEVBQUU7UUFDNUIsSUFBSSxhQUFhLENBQUMsS0FBSyxFQUFFO1lBQ3ZCLE1BQU0sY0FBYyxHQUFHLGFBQWEsQ0FBQyxJQUFJLENBQUM7WUFDMUMsUUFBUTtZQUNSLGFBQWEsQ0FBQyxJQUFJLEdBQUcsYUFBYSxDQUFDLEtBQUssQ0FBQztZQUN6QyxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxhQUFhLENBQUM7WUFFekMsU0FBUztZQUNULElBQUksVUFBVSxHQUFHLGFBQWEsQ0FBQyxLQUFLLENBQUM7WUFDckMsT0FBTyxVQUFVLENBQUMsSUFBSSxJQUFJLElBQUksRUFBRTtnQkFDOUIsVUFBVSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUM7YUFDOUI7WUFFRCxPQUFPO1lBQ1AsSUFBSSxjQUFjO2dCQUFFLGNBQWMsQ0FBQyxJQUFJLEdBQUcsVUFBVSxDQUFDO1lBQ3JELFVBQVUsQ0FBQyxJQUFJLEdBQUcsY0FBYyxDQUFDO1lBQ2pDLGFB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QztJQUMzQyxNQUFNLE1BQU0sR0FBRyx5Q0FBc0IsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDckQsTUFBTSxNQUFNLEdBQUcseUNBQXNCLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUVoRCxNQUFNLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztJQUN0QixNQUFNLENBQUMsSUFBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7SUFFNUIsZ0JBQU0sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBRSxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztDQUMvRTtBQUNEO0lBQ0UsTUFBTSxNQUFNLEdBQUcseUNBQXNCLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzNDLE1BQU0sTUFBTSxHQUFHLHlDQUFzQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMzQyxNQUFNLE1BQU0sR0FBRyx5Q0FBc0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFM0MsTUFBTSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7SUFDdEIsTUFBTSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7SUFFdEIsZ0JBQU0sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBRSxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0NBQ2hFO0FBQ0Q7SUFDRSxNQUFNLE1BQU0sR0FBRyx5Q0FBc0IsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDcEQsTUFBTSxNQUFNLEdBQUcseUNBQXNCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM5QyxNQUFNLE1BQU0sR0FBRyx5Q0FBc0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFM0MsTUFBTSxDQUFDLElBQUssQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDO0lBQzVCLE1BQU0sQ0FBQyxJQUFLLENBQUMsSUFBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7SUFFbEMsZ0JBQU0sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBRSxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztDQUM1RTtBQUVEOztLQUVLO0FBQ0wsTUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQ3ZDO0lBQ0UsTUFBTSxXQUFXLEdBQUcsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUNsQyxJQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO0lBQ2xELE1BQU0sS0FBSyxHQUFHLElBQUksU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3BDLE1BQU0sTUFBTSxHQUFHLHlDQUFzQixDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzFELE1BQU0sTUFBTSxHQUFHLHlDQUFzQixDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBQzFELE1BQU0sTUFBTSxHQUFHLHlDQUFzQixDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0lBRTFELE1BQU0sQ0FBQyxJQUFLLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztJQUM1QixNQUFNLENBQUMsSUFBSyxDQUFDLElBQUssQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDO0lBRWxDLEtBQUs7U0FDRixHQUFHLENBQUMsS0FBSyxFQUFFO1FBQ1YsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2xCLENBQUMsQ0FBQztTQUNELEdBQUcsQ0FBQyxNQUFNLEVBQUU7UUFDWCxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDbkIsQ0FBQyxDQUFDO1FBRUYsZ0JBQWdCO1NBQ2YsRUFBRSxDQUFDLE9BQU8sRUFBRSxVQUFVLEtBQVU7UUFDL0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDcEMsQ0FBQyxDQUFDO1NBQ0QsRUFBRSxDQUFDLFVBQVUsRUFBRTtRQUNkLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDbEUsQ0FBQyxDQUFDO1FBQ0YsWUFBWTtTQUNYLEdBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0NBQzFCIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxu5oKo5bCG6I635b6X5LiA5Liq5Y+M5ZCR6ZO+6KGo77yM6Zmk5LqG5LiL5LiA5Liq5ZKM5YmN5LiA5Liq5oyH6ZKI5LmL5aSW77yM5a6D6L+Y5pyJ5LiA5Liq5a2Q5oyH6ZKI77yM5Y+v6IO95oyH5ZCR5Y2V54us55qE5Y+M5ZCR6ZO+6KGo44CCXHJcbui/meS6m+WtkOWIl+ihqOWPr+iDveacieS4gOS4quaIluWkmuS4quiHquW3seeahOWtkOmhue+8jOS+neatpOexu+aOqO+8jOeUn+aIkOWkmue6p+aVsOaNrue7k+aehO+8jOWmguS4i+mdoueahOekuuS+i+aJgOekuuOAglxyXG5cclxu5omB5bmz5YyW5YiX6KGo77yM5L2/5omA5pyJ57uT54K55Ye6546w5Zyo5Y2V57qn5Y+M6ZO+6KGo5Lit44CC5oKo5bCG6I635b6X5YiX6KGo56ys5LiA57qn55qE5aS06YOo44CCXHJcblxyXG7npLrkvos6XHJcblxyXG7ovpPlhaU6XHJcbiAxLCwsMiwsLDMsLCw0LCwsNSwsLDYsLE5VTExcclxuICAgICAgICAgfFxyXG4gICAgICAgICA3LCwsOCwsLDksLCwxMCwsTlVMTFxyXG4gICAgICAgICAgICAgfFxyXG4gICAgICAgICAgICAgMTEsLDEyLCxOVUxMXHJcblxyXG7ovpPlh7o6XHJcbjEsMiwzLDcsOCwxMSwxMiw5LDEwLDQsNSw2LE5VTExcclxuXHJcbuadpea6kO+8muWKm+aJo++8iExlZXRDb2Rl77yJXHJcbumTvuaOpe+8mmh0dHBzOi8vbGVldGNvZGUsY24uY29tL3Byb2JsZW1zL2ZsYXR0ZW4sYSxtdWx0aWxldmVsLGRvdWJseSxsaW5rZWQsbGlzdFxyXG7okZfkvZzmnYPlvZLpoobmiaPnvZHnu5zmiYDmnInjgILllYbkuJrovazovb3or7fogZTns7vlrpjmlrnmjojmnYPvvIzpnZ7llYbkuJrovazovb3or7fms6jmmI7lh7rlpITjgIJcclxuKiAqL1xyXG5cclxuY2xhc3MgTm9kZTxUID0gYW55PiB7XHJcbiAgcHJldjogbnVsbCB8IE5vZGUgPSBudWxsO1xyXG4gIGNoaWxkOiBudWxsIHwgTm9kZSA9IG51bGw7XHJcbiAgbmV4dDogbnVsbCB8IE5vZGUgPSBudWxsO1xyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgdmFsOiBUKSB7XHJcbiAgICB0aGlzLnZhbCA9IHZhbDtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0ge05vZGV9IGhlYWRcclxuICogQHJldHVybiB7Tm9kZX1cclxuICovXHJcbnZhciBmbGF0dGVuID0gZnVuY3Rpb24gKGhlYWQ6IE5vZGUgfCBudWxsKSB7XHJcbiAgbGV0IGxlZnRfanVuY3Rpb24gPSBoZWFkO1xyXG4gIHdoaWxlIChsZWZ0X2p1bmN0aW9uICE9IG51bGwpIHtcclxuICAgIGlmIChsZWZ0X2p1bmN0aW9uLmNoaWxkKSB7XHJcbiAgICAgIGNvbnN0IHJpZ2h0X2p1bmN0aW9uID0gbGVmdF9qdW5jdGlvbi5uZXh0O1xyXG4gICAgICAvLyDov57mjqUg5bem5L6nXHJcbiAgICAgIGxlZnRfanVuY3Rpb24ubmV4dCA9IGxlZnRfanVuY3Rpb24uY2hpbGQ7XHJcbiAgICAgIGxlZnRfanVuY3Rpb24uY2hpbGQucHJldiA9IGxlZnRfanVuY3Rpb247XHJcblxyXG4gICAgICAvLyDmib7liLAg5bC+6IqC54K5XHJcbiAgICAgIGxldCBjaGlsZF90YWlsID0gbGVmdF9qdW5jdGlvbi5jaGlsZDtcclxuICAgICAgd2hpbGUgKGNoaWxkX3RhaWwubmV4dCAhPSBudWxsKSB7XHJcbiAgICAgICAgY2hpbGRfdGFpbCA9IGNoaWxkX3RhaWwubmV4dDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g6L+e5o6l5Y+z5L6nXHJcbiAgICAgIGlmIChyaWdodF9qdW5jdGlvbikgcmlnaHRfanVuY3Rpb24ucHJldiA9IGNoaWxkX3RhaWw7XHJcbiAgICAgIGNoaWxkX3RhaWwubmV4dCA9IHJpZ2h0X2p1bmN0aW9uO1xyXG4gICAgICBsZWZ0X2p1bmN0aW9uLmNoaWxkID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnu6fnu63pgY3ljoZcclxuICAgIGxlZnRfanVuY3Rpb24gPSBsZWZ0X2p1bmN0aW9uLm5leHQ7XHJcbiAgfVxyXG4gIHJldHVybiBoZWFkO1xyXG59O1xyXG4vKipcclxuICog6Jm954S25oiR55qE5pa55rOV5piv6YCS5b2S5L2G5pivIOaIkeeahOaWueazlSDmr4/kuKroioLngrnnmoTlj6rorr/pl67kuIDmrKEg5L2G5piv5oWiP1xyXG4gKiAqL1xyXG52YXIgZmxhdHRlbjEgPSBmdW5jdGlvbiAoaGVhZDogTm9kZSB8IG51bGwpIHtcclxuICBpZiAoaGVhZCA9PSBudWxsKSByZXR1cm4gbnVsbDtcclxuICBsZXQgbGVmdF9qdW5jdGlvbjogTm9kZTtcclxuICBzdGVwKGhlYWQpO1xyXG4gIHJldHVybiBoZWFkO1xyXG5cclxuICBmdW5jdGlvbiBzdGVwKGhlYWQ6IE5vZGUpIHtcclxuICAgIGxldCBuZXh0ID0gbnVsbDtcclxuICAgIGlmIChsZWZ0X2p1bmN0aW9uKSB7XHJcbiAgICAgIG5leHQgPSBsZWZ0X2p1bmN0aW9uLm5leHQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFsZWZ0X2p1bmN0aW9uKSB7XHJcbiAgICAgIGxlZnRfanVuY3Rpb24gPSBoZWFkO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGVmdF9qdW5jdGlvbi5uZXh0ID0gaGVhZDtcclxuICAgICAgaGVhZC5wcmV2ID0gbGVmdF9qdW5jdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgY3VycmVudE5vZGUgPSBoZWFkO1xyXG4gICAgbGV0IHRhaWwgPSBjdXJyZW50Tm9kZTtcclxuICAgIHdoaWxlIChjdXJyZW50Tm9kZSkge1xyXG4gICAgICBsZWZ0X2p1bmN0aW9uID0gY3VycmVudE5vZGU7XHJcbiAgICAgIGlmIChjdXJyZW50Tm9kZS5jaGlsZCkge1xyXG4gICAgICAgIHN0ZXAoY3VycmVudE5vZGUuY2hpbGQpO1xyXG4gICAgICAgIGN1cnJlbnROb2RlLmNoaWxkID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICB0YWlsID0gY3VycmVudE5vZGU7XHJcbiAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUubmV4dCE7XHJcbiAgICAgIC8vIGxlZnRfanVuY3Rpb24gPSBjdXJyZW50Tm9kZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAobmV4dCAhPSBudWxsKSB7XHJcbiAgICAgIG5leHQucHJldiA9IHRhaWw7XHJcbiAgICB9XHJcbiAgICB0YWlsLm5leHQgPSBuZXh0O1xyXG4gIH1cclxufTtcclxuXHJcbmltcG9ydCBhc3NlcnQgZnJvbSBcImFzc2VydFwiO1xyXG5pbXBvcnQgeyBjcmVhdGVEb3VibGVMaW5rZWRMaXN0IH0gZnJvbSBcIi4uL3V0aWwvRG91YmxlTGlua2VkTGlzdFwiO1xyXG5cclxue1xyXG4gIGNvbnN0IGxpbmVfMSA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzFdKTtcclxuXHJcbiAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmbGF0dGVuKGxpbmVfMSkhLnRvU3RyaW5nKCksIFsxXSk7XHJcbn1cclxue1xyXG4gIGNvbnN0IGxpbmVfMSA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzEsIDIsIDMsIDQsIDUsIDZdKTtcclxuICBjb25zdCBsaW5lXzIgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFs3LCA4LCA5LCAxMF0pO1xyXG4gIGNvbnN0IGxpbmVfMyA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzExLCAxMl0pO1xyXG5cclxuICBsaW5lXzEubmV4dCEubmV4dCEuY2hpbGQgPSBsaW5lXzI7XHJcbiAgbGluZV8yLm5leHQhLmNoaWxkID0gbGluZV8zO1xyXG5cclxuICBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZsYXR0ZW4obGluZV8xKSEudG9TdHJpbmcoKSwgW1xyXG4gICAgMSxcclxuICAgIDIsXHJcbiAgICAzLFxyXG4gICAgNyxcclxuICAgIDgsXHJcbiAgICAxMSxcclxuICAgIDEyLFxyXG4gICAgOSxcclxuICAgIDEwLFxyXG4gICAgNCxcclxuICAgIDUsXHJcbiAgICA2LFxyXG4gIF0pO1xyXG59XHJcbntcclxuICBjb25zdCBsaW5lXzEgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFsxXSk7XHJcbiAgY29uc3QgbGluZV8yID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChbNywgOCwgOSwgMTBdKTtcclxuICBjb25zdCBsaW5lXzMgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFsxMSwgMTJdKTtcclxuXHJcbiAgbGluZV8xLmNoaWxkID0gbGluZV8yO1xyXG4gIGxpbmVfMi5uZXh0IS5jaGlsZCA9IGxpbmVfMztcclxuXHJcbiAgYXNzZXJ0LmRlZXBTdHJpY3RFcXVhbChmbGF0dGVuKGxpbmVfMSkhLnRvU3RyaW5nKCksIFsxLCA3LCA4LCAxMSwgMTIsIDksIDEwXSk7XHJcbn1cclxue1xyXG4gIGNvbnN0IGxpbmVfMSA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzFdKTtcclxuICBjb25zdCBsaW5lXzIgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFsyXSk7XHJcbiAgY29uc3QgbGluZV8zID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChbM10pO1xyXG5cclxuICBsaW5lXzEuY2hpbGQgPSBsaW5lXzI7XHJcbiAgbGluZV8yLmNoaWxkID0gbGluZV8zO1xyXG5cclxuICBhc3NlcnQuZGVlcFN0cmljdEVxdWFsKGZsYXR0ZW4obGluZV8xKSEudG9TdHJpbmcoKSwgWzEsIDIsIDNdKTtcclxufVxyXG57XHJcbiAgY29uc3QgbGluZV8xID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChbMSwgMiwgNSwgN10pO1xyXG4gIGNvbnN0IGxpbmVfMiA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QoWzMsIDRdKTtcclxuICBjb25zdCBsaW5lXzMgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KFs2XSk7XHJcblxyXG4gIGxpbmVfMS5uZXh0IS5jaGlsZCA9IGxpbmVfMjtcclxuICBsaW5lXzEubmV4dCEubmV4dCEuY2hpbGQgPSBsaW5lXzM7XHJcblxyXG4gIGFzc2VydC5kZWVwU3RyaWN0RXF1YWwoZmxhdHRlbihsaW5lXzEpIS50b1N0cmluZygpLCBbMSwgMiwgMywgNCwgNSwgNiwgN10pO1xyXG59XHJcblxyXG4vKipcclxuICog5LqL5a6e6K+B5piOIOWcqOmTvuihqOi2s+Wkn+mVv+mineaDheWGteS4iyDmiJHnmoTmlrnms5Xmm7Tlv6vllYpcclxuICogKi9cclxuY29uc3QgQmVuY2htYXJrID0gcmVxdWlyZShcImJlbmNobWFya1wiKTtcclxue1xyXG4gIGNvbnN0IHJhbmRvbUFycmF5ID0gKG51bTogbnVtYmVyKSA9PlxyXG4gICAgbmV3IEFycmF5KG51bSkuZmlsbCgxKS5tYXAoKCkgPT4gTWF0aC5yYW5kb20oKSk7XHJcbiAgY29uc3Qgc3VpdGUgPSBuZXcgQmVuY2htYXJrLlN1aXRlKCk7XHJcbiAgY29uc3QgbGluZV8xID0gY3JlYXRlRG91YmxlTGlua2VkTGlzdChyYW5kb21BcnJheSgxMDAwMCkpO1xyXG4gIGNvbnN0IGxpbmVfMiA9IGNyZWF0ZURvdWJsZUxpbmtlZExpc3QocmFuZG9tQXJyYXkoMTAwMDApKTtcclxuICBjb25zdCBsaW5lXzMgPSBjcmVhdGVEb3VibGVMaW5rZWRMaXN0KHJhbmRvbUFycmF5KDEwMDAwKSk7XHJcblxyXG4gIGxpbmVfMS5uZXh0IS5jaGlsZCA9IGxpbmVfMjtcclxuICBsaW5lXzEubmV4dCEubmV4dCEuY2hpbGQgPSBsaW5lXzM7XHJcblxyXG4gIHN1aXRlXHJcbiAgICAuYWRkKFwidG9wXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgZmxhdHRlbihsaW5lXzEpO1xyXG4gICAgfSlcclxuICAgIC5hZGQoXCJtaW5lXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgZmxhdHRlbjEobGluZV8xKTtcclxuICAgIH0pXHJcblxyXG4gICAgLy8gYWRkIGxpc3RlbmVyc1xyXG4gICAgLm9uKFwiY3ljbGVcIiwgZnVuY3Rpb24gKGV2ZW50OiBhbnkpIHtcclxuICAgICAgY29uc29sZS5sb2coU3RyaW5nKGV2ZW50LnRhcmdldCkpO1xyXG4gICAgfSlcclxuICAgIC5vbihcImNvbXBsZXRlXCIsIGZ1bmN0aW9uICh0aGlzOiBhbnkpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJGYXN0ZXN0IGlzIFwiICsgdGhpcy5maWx0ZXIoXCJmYXN0ZXN0XCIpLm1hcChcIm5hbWVcIikpO1xyXG4gICAgfSlcclxuICAgIC8vIHJ1biBhc3luY1xyXG4gICAgLnJ1bih7IGFzeW5jOiBmYWxzZSB9KTtcclxufVxyXG4iXX0=