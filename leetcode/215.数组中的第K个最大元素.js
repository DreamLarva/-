"use strict";
var __importDefault =
  (this && this.__importDefault) ||
  function (mod) {
    return mod && mod.__esModule ? mod : { default: mod };
  };
Object.defineProperty(exports, "__esModule", { value: true });
/*
在未排序的数组中找到第 k 个最大的元素。请注意，你需要找的是数组排序后的第 k 个最大的元素，而不是第 k 个不同的元素。

示例 1:

输入: [3,2,1,5,6,4] 和 k = 2
输出: 5
示例 2:

输入: [3,2,3,1,2,4,5,5,6] 和 k = 4
输出: 4
说明:

你可以假设 k 总是有效的，且 1 ≤ k ≤ 数组的长度。

来源：力扣（LeetCode）
链接：https://leetcode-cn.com/problems/kth-largest-element-in-an-array
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。
* */
const lodash_1 = __importDefault(require("lodash"));
/**
 * @param {number[]} nums
 * @param {number} k
 * @return {number}
 */
var findKthLargest = function (nums, k) {
  /**
   * 方法一 不断的堆化(求第k大的值 用**最小堆**) 并且保持 一定的长度(k)
   * 慢的一b
   * */
  const minHeap = [];
  for (let i = 0; i < nums.length; i++) {
    // 优化 如果小于顶部 就直接 过
    if (minHeap.length === k && nums[i] < minHeap[0]) continue;
    minHeap.push(nums[i]);
    heapifyWithSiftDown(minHeap);
    if (minHeap.length > k) {
      minHeap.shift();
    }
  }
  // 还必须再堆化一次 使最小值 在第一个
  heapifyWithSiftDown(minHeap);
  return minHeap[0];
  function heapifyWithSiftDown(A) {
    // 初始选择最接近叶子的一个父结点
    for (let i = Math.floor((A.length - 1) / 2); i >= 0; i--) {
      siftDown(A, i);
    }
    return A;
  }
  function siftDown(A, k) {
    // 此处是 最小堆
    while (k * 2 + 1 < A.length) {
      let son = k * 2 + 1;
      // 与其两个儿子中较小的一个比较
      if (k * 2 + 2 < A.length && A[son] > A[k * 2 + 2]) {
        son = k * 2 + 2;
      }
      // 若大于儿子，则与儿子交换。
      if (A[son] > A[k]) {
        break;
      }
      [A[son], A[k]] = [A[k], A[son]];
      // 交换后再与新的儿子比较并交换，直至没有儿子。
      k = son;
    }
  }
};
var findKthLargest_1 = function (nums, k) {
  /**
   * 方法二 快速选择法(Hoare 选择法)
   * */
  const size = nums.length;
  return quickSelect(0, size - 1, size - k);
  function partition(left, right, pivot_index) {
    let pivot = nums[pivot_index];
    // 现将 枢轴 换到末尾 方便 操作
    [nums[pivot_index], nums[right]] = [nums[right], nums[pivot_index]];
    // 存储 枢轴新的位置
    let store_index = left;
    // 枢轴的值 放到左边
    for (let i = left; i <= right; i++) {
      if (nums[i] < pivot) {
        [nums[store_index], nums[i]] = [nums[i], nums[store_index]];
        store_index++;
      }
    }
    // 将在最末尾的枢轴的值 放到新的位置
    [nums[store_index], nums[right]] = [nums[right], nums[store_index]];
    return store_index;
  }
  function quickSelect(left, right, k_smallest) {
    // 如果 左右为 同一个值 那么说明 只有一个值 不需要再选择了
    if (left === right) {
      return nums[left];
    }
    // 随机 用一个值作为 index 作为枢轴 并且返回 枢轴的 index
    let pivot_index = partition(
      left,
      right,
      lodash_1.default.random(left, right - 1)
    ); // lodash 的 random 是含头 含尾的
    if (k_smallest === pivot_index) return nums[k_smallest];
    // 如果 枢轴的 index 小于 k_smallest 说明 值 还在有枢轴的右侧
    else if (k_smallest < pivot_index)
      return quickSelect(left, pivot_index - 1, k_smallest);
    // 如果 枢轴的 index 大于 k_smallest 说明 值 还在有枢轴的左侧
    return quickSelect(pivot_index + 1, right, k_smallest);
  }
};
const assert_1 = __importDefault(require("assert"));
assert_1.default.strictEqual(findKthLargest([3, 2, 1, 5, 6, 4], 2), 5);
assert_1.default.strictEqual(findKthLargest([3, 2, 3, 1, 2, 4, 5, 5, 6], 4), 4);
assert_1.default.strictEqual(findKthLargest_1([3, 2, 1, 5, 6, 4], 2), 5);
assert_1.default.strictEqual(
  findKthLargest_1([3, 2, 3, 1, 2, 4, 5, 5, 6], 4),
  4
);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjE1LuaVsOe7hOS4reeahOesrEvkuKrmnIDlpKflhYPntKAuanMiLCJzb3VyY2VSb290IjoiLi8iLCJzb3VyY2VzIjpbImxlZXRjb2RlLzIxNS7mlbDnu4TkuK3nmoTnrKxL5Liq5pyA5aSn5YWD57SgLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQWtCSTtBQUNKLG9EQUF1QjtBQUV2Qjs7OztHQUlHO0FBQ0gsSUFBSSxjQUFjLEdBQUcsVUFBVSxJQUFjLEVBQUUsQ0FBUztJQUNwRDs7O1NBR0s7SUFDTCxNQUFNLE9BQU8sR0FBRyxFQUFFLENBQUM7SUFDbkIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDbEMsa0JBQWtCO1FBQ2xCLElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFBRSxTQUFTO1FBQzNELE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEIsbUJBQW1CLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDN0IsSUFBSSxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUNwQixPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7U0FDbkI7S0FDSjtJQUNELHFCQUFxQjtJQUNyQixtQkFBbUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM3QixPQUFPLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVsQixTQUFTLG1CQUFtQixDQUFDLENBQVc7UUFDcEMsa0JBQWtCO1FBQ2xCLEtBQUssSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJ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QyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQ2hELENBQUMsQ0FDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbuWcqOacquaOkuW6j+eahOaVsOe7hOS4reaJvuWIsOesrCBrIOS4quacgOWkp+eahOWFg+e0oOOAguivt+azqOaEj++8jOS9oOmcgOimgeaJvueahOaYr+aVsOe7hOaOkuW6j+WQjueahOesrCBrIOS4quacgOWkp+eahOWFg+e0oO+8jOiAjOS4jeaYr+esrCBrIOS4quS4jeWQjOeahOWFg+e0oOOAglxuXG7npLrkvosgMTpcblxu6L6T5YWlOiBbMywyLDEsNSw2LDRdIOWSjCBrID0gMlxu6L6T5Ye6OiA1XG7npLrkvovCoDI6XG5cbui+k+WFpTogWzMsMiwzLDEsMiw0LDUsNSw2XSDlkowgayA9IDRcbui+k+WHujogNFxu6K+05piOOlxuXG7kvaDlj6/ku6XlgYforr4gayDmgLvmmK/mnInmlYjnmoTvvIzkuJQgMSDiiaQgayDiiaQg5pWw57uE55qE6ZW/5bqm44CCXG5cbuadpea6kO+8muWKm+aJo++8iExlZXRDb2Rl77yJXG7pk77mjqXvvJpodHRwczovL2xlZXRjb2RlLWNuLmNvbS9wcm9ibGVtcy9rdGgtbGFyZ2VzdC1lbGVtZW50LWluLWFuLWFycmF5XG7okZfkvZzmnYPlvZLpoobmiaPnvZHnu5zmiYDmnInjgILllYbkuJrovazovb3or7fogZTns7vlrpjmlrnmjojmnYPvvIzpnZ7llYbkuJrovazovb3or7fms6jmmI7lh7rlpITjgIJcbiogKi9cbmltcG9ydCBfIGZyb20gXCJsb2Rhc2hcIjtcblxuLyoqXG4gKiBAcGFyYW0ge251bWJlcltdfSBudW1zXG4gKiBAcGFyYW0ge251bWJlcn0ga1xuICogQHJldHVybiB7bnVtYmVyfVxuICovXG52YXIgZmluZEt0aExhcmdlc3QgPSBmdW5jdGlvbiAobnVtczogbnVtYmVyW10sIGs6IG51bWJlcikge1xuICAgIC8qKlxuICAgICAqIOaWueazleS4gCDkuI3mlq3nmoTloIbljJYo5rGC56ysa+Wkp+eahOWAvCDnlKgqKuacgOWwj+WghioqKSDlubbkuJTkv53mjIEg5LiA5a6a55qE6ZW/5bqmKGspXG4gICAgICog5oWi55qE5LiAYlxuICAgICAqICovXG4gICAgY29uc3QgbWluSGVhcCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAvLyDkvJjljJYg5aaC5p6c5bCP5LqO6aG26YOoIOWwseebtOaOpSDov4dcbiAgICAgICAgaWYgKG1pbkhlYXAubGVuZ3RoID09PSBrICYmIG51bXNbaV0gPCBtaW5IZWFwWzBdKSBjb250aW51ZTtcbiAgICAgICAgbWluSGVhcC5wdXNoKG51bXNbaV0pO1xuICAgICAgICBoZWFwaWZ5V2l0aFNpZnREb3duKG1pbkhlYXApO1xuICAgICAgICBpZiAobWluSGVhcC5sZW5ndGggPiBrKSB7XG4gICAgICAgICAgICBtaW5IZWFwLnNoaWZ0KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8g6L+Y5b+F6aG75YaN5aCG5YyW5LiA5qyhIOS9v+acgOWwj+WAvCDlnKjnrKzkuIDkuKpcbiAgICBoZWFwaWZ5V2l0aFNpZnREb3duKG1pbkhlYXApO1xuICAgIHJldHVybiBtaW5IZWFwWzBdO1xuXG4gICAgZnVuY3Rpb24gaGVhcGlmeVdpdGhTaWZ0RG93bihBOiBudW1iZXJbXSkge1xuICAgICAgICAvLyDliJ3lp4vpgInmi6nmnIDmjqXov5Hlj7blrZDnmoTkuIDkuKrniLbnu5PngrlcbiAgICAgICAgZm9yIChsZXQgaSA9IE1hdGguZmxvb3IoKEEubGVuZ3RoIC0gMSkgLyAyKTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHNpZnREb3duKEEsIGkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIEE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2lmdERvd24oQTogbnVtYmVyW10sIGs6IG51bWJlcikge1xuICAgICAgICAvLyDmraTlpITmmK8g5pyA5bCP5aCGXG4gICAgICAgIHdoaWxlIChrICogMiArIDEgPCBBLmxlbmd0aCkge1xuICAgICAgICAgICAgbGV0IHNvbiA9IGsgKiAyICsgMTtcbiAgICAgICAgICAgIC8vIOS4juWFtuS4pOS4quWEv+WtkOS4rei+g+Wwj+eahOS4gOS4quavlOi+g1xuICAgICAgICAgICAgaWYgKGsgKiAyICsgMiA8IEEubGVuZ3RoICYmIEFbc29uXSA+IEFbayAqIDIgKyAyXSkge1xuICAgICAgICAgICAgICAgIHNvbiA9IGsgKiAyICsgMjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8g6Iul5aSn5LqO5YS/5a2Q77yM5YiZ5LiO5YS/5a2Q5Lqk5o2i44CCXG4gICAgICAgICAgICBpZiAoQVtzb25dID4gQVtrXSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgW0Fbc29uXSwgQVtrXV0gPSBbQVtrXSwgQVtzb25dXTtcbiAgICAgICAgICAgIC8vIOS6pOaNouWQjuWGjeS4juaWsOeahOWEv+WtkOavlOi+g+W5tuS6pOaNou+8jOebtOiHs+ayoeacieWEv+WtkOOAglxuICAgICAgICAgICAgayA9IHNvbjtcbiAgICAgICAgfVxuICAgIH1cblxuXG59O1xuXG52YXIgZmluZEt0aExhcmdlc3RfMSA9IGZ1bmN0aW9uIChudW1zOiBudW1iZXJbXSwgazogbnVtYmVyKSB7XG4gICAgLyoqXG4gICAgICog5pa55rOV5LqMIOW/q+mAn+mAieaLqeazlShIb2FyZSDpgInmi6nms5UpXG4gICAgICogKi9cbiAgICBjb25zdCBzaXplID0gbnVtcy5sZW5ndGg7XG4gICAgcmV0dXJuIHF1aWNrU2VsZWN0KDAsIHNpemUgLSAxLCBzaXplIC0gayk7XG5cbiAgICBmdW5jdGlvbiBwYXJ0aXRpb24obGVmdDogbnVtYmVyLCByaWdodDogbnVtYmVyLCBwaXZvdF9pbmRleDogbnVtYmVyKSB7XG4gICAgICAgIGxldCBwaXZvdCA9IG51bXNbcGl2b3RfaW5kZXhdO1xuICAgICAgICAvLyDnjrDlsIYg5p6i6L20IOaNouWIsOacq+WwviDmlrnkvr8g5pON5L2cXG4gICAgICAgIFtudW1zW3Bpdm90X2luZGV4XSwgbnVtc1tyaWdodF1dID0gW251bXNbcmlnaHRdLCBudW1zW3Bpdm90X2luZGV4XV07XG4gICAgICAgIC8vIOWtmOWCqCDmnqLovbTmlrDnmoTkvY3nva5cbiAgICAgICAgbGV0IHN0b3JlX2luZGV4ID0gbGVmdDtcblxuICAgICAgICAvLyDmnqLovbTnmoTlgLwg5pS+5Yiw5bem6L65XG4gICAgICAgIGZvciAobGV0IGkgPSBsZWZ0OyBpIDw9IHJpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChudW1zW2ldIDwgcGl2b3QpIHtcbiAgICAgICAgICAgICAgICBbbnVtc1tzdG9yZV9pbmRleF0sIG51bXNbaV1dID0gW251bXNbaV0sIG51bXNbc3RvcmVfaW5kZXhdXTtcbiAgICAgICAgICAgICAgICBzdG9yZV9pbmRleCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIOWwhuWcqOacgOacq+WwvueahOaeoui9tOeahOWAvCDmlL7liLDmlrDnmoTkvY3nva5cbiAgICAgICAgW251bXNbc3RvcmVfaW5kZXhdLCBudW1zW3JpZ2h0XV0gPSBbbnVtc1tyaWdodF0sIG51bXNbc3RvcmVfaW5kZXhdXTtcbiAgICAgICAgcmV0dXJuIHN0b3JlX2luZGV4O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHF1aWNrU2VsZWN0KGxlZnQ6IG51bWJlciwgcmlnaHQ6IG51bWJlciwga19zbWFsbGVzdDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgLy8g5aaC5p6cIOW3puWPs+S4uiDlkIzkuIDkuKrlgLwg6YKj5LmI6K+05piOIOWPquacieS4gOS4quWAvCDkuI3pnIDopoHlho3pgInmi6nkuoZcbiAgICAgICAgaWYgKGxlZnQgPT09IHJpZ2h0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVtc1tsZWZ0XTtcbiAgICAgICAgfVxuICAgICAgICAvLyDpmo/mnLog55So5LiA5Liq5YC85L2c5Li6IGluZGV4IOS9nOS4uuaeoui9tCDlubbkuJTov5Tlm54g5p6i6L2055qEIGluZGV4XG4gICAgICAgIGxldCBwaXZvdF9pbmRleCA9IHBhcnRpdGlvbihsZWZ0LCByaWdodCwgXy5yYW5kb20obGVmdCwgcmlnaHQgLSAxKSk7IC8vIGxvZGFzaCDnmoQgcmFuZG9tIOaYr+WQq+WktCDlkKvlsL7nmoRcblxuICAgICAgICBpZiAoa19zbWFsbGVzdCA9PT0gcGl2b3RfaW5kZXgpIHJldHVybiBudW1zW2tfc21hbGxlc3RdO1xuICAgICAgICAvLyDlpoLmnpwg5p6i6L2055qEIGluZGV4IOWwj+S6jiBrX3NtYWxsZXN0IOivtOaYjiDlgLwg6L+Y5Zyo5pyJ5p6i6L2055qE5Y+z5L6nXG4gICAgICAgIGVsc2UgaWYgKGtfc21hbGxlc3QgPCBwaXZvdF9pbmRleCkgcmV0dXJuIHF1aWNrU2VsZWN0KGxlZnQsIHBpdm90X2luZGV4IC0gMSwga19zbWFsbGVzdCk7XG4gICAgICAgIC8vIOWmguaenCDmnqLovbTnmoQgaW5kZXgg5aSn5LqOIGtfc21hbGxlc3Qg6K+05piOIOWAvCDov5jlnKjmnInmnqLovbTnmoTlt6bkvqdcbiAgICAgICAgcmV0dXJuIHF1aWNrU2VsZWN0KHBpdm90X2luZGV4ICsgMSwgcmlnaHQsIGtfc21hbGxlc3QpO1xuXG4gICAgfVxuXG5cbn07XG5cbmltcG9ydCBhc3NlcnQgZnJvbSAnYXNzZXJ0JztcblxuYXNzZXJ0LnN0cmljdEVxdWFsKFxuICAgIGZpbmRLdGhMYXJnZXN0KFszLCAyLCAxLCA1LCA2LCA0XSwgMiksXG4gICAgNSxcbik7XG5hc3NlcnQuc3RyaWN0RXF1YWwoXG4gICAgZmluZEt0aExhcmdlc3QoWzMsIDIsIDMsIDEsIDIsIDQsIDUsIDUsIDZdLCA0KSxcbiAgICA0LFxuKTtcbmFzc2VydC5zdHJpY3RFcXVhbChcbiAgICBmaW5kS3RoTGFyZ2VzdF8xKFszLCAyLCAxLCA1LCA2LCA0XSwgMiksXG4gICAgNSxcbik7XG5hc3NlcnQuc3RyaWN0RXF1YWwoXG4gICAgZmluZEt0aExhcmdlc3RfMShbMywgMiwgMywgMSwgMiwgNCwgNSwgNSwgNl0sIDQpLFxuICAgIDQsXG4pO1xuIl19
